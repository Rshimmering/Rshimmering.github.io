<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>Python——第7章 pandas数据分析实战 | Rshimmer</title><meta name="keywords" content="Python,pandas"><meta name="author" content="Rshimmer"><meta name="copyright" content="Rshimmer"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#F0E68C"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Python——第7章 pandas数据分析实战"><meta name="application-name" content="Python——第7章 pandas数据分析实战"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#F0E68C"><meta property="og:type" content="article"><meta property="og:title" content="Python——第7章 pandas数据分析实战"><meta property="og:url" content="https://rshimmering.github.io/posts/d966146.html"><meta property="og:site_name" content="Rshimmer"><meta property="og:description" content="pandas常用数据类型 一维数组与常用操作 1234567891011121314import pandas as pdimport matplotlib.pyplot as plt#设置输出结果对齐方式pd.set_option(&amp;amp;#x27;display.unicode.ambiguous_a"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://rshimmering.github.io/pageimg/2027105.jpg"><meta property="article:author" content="Rshimmer"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://rshimmering.github.io/pageimg/2027105.jpg"><link rel="shortcut icon" href="/img/feng.png"><link rel="canonical" href="https://rshimmering.github.io/posts/d966146"><link rel="preconnect" href="//npm.elemecdn.com"><link rel="preconnect" href="//npm.onmicrosoft.cn"><meta name="google-site-verification" content="xxx"><meta name="baidu-site-verification" content="code-xxx"><meta name="msvalidate.01" content="xxx"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.14/dist/fancybox/fancybox.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG = { 
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":null},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#76B6EA","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Python——第7章 pandas数据分析实战",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-07-16 23:24:26",postMainColor:""}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#F0E68C')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#F0E68C')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/iconfont.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"><meta name="generator" content="Hexo 6.3.0"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/img/t.jpg"><div class="loading-image-dot"></div><div id="loading-percentage">0%</div></div></div><script>if (GLOBAL_CONFIG.preloader.source == "2" || GLOBAL_CONFIG.preloader.source == "3") {
  const loadingPercentage = document.getElementById("loading-percentage");
  let loadingPercentageTimer = setInterval(function() {
    var progressBar = document.querySelector(".pace-progress");
    if (!progressBar) return
    var currentValue = progressBar.getAttribute("data-progress-text");
    if (currentValue !== loadingPercentage.textContent) {
      loadingPercentage.textContent = currentValue;
      if (currentValue === "100%") {
        clearInterval(loadingPercentageTimer);
      }
    }
  }, 100);
}

const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/progress_bar/progress_bar.css"><script async src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div id="web_box"><div id="web_container"><div id="menu-mask"></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">Rshimmer</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span>文章</span></a><ul class="menus_item_child" style="left:-79px"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size:.9em"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size:.9em"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size:.9em"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child" style="left:-31px"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size:.9em"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size:.9em"></i><span> 百宝箱</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span>关于</span></a><ul class="menus_item_child" style="left:-79px"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size:.9em"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size:.9em"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size:.9em"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole()"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="wechat" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="alipay" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"></a><div class="post-qr-code-desc">alipay</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"><span>最新评论</span></span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">音乐</div><span class="author-content-item-title">灵魂的碰撞💥</span></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">八月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">七月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/06/"><span class="card-archive-list-date">六月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">36</span><span>篇</span></div></a></li></ul></div><hr></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" onclick="anzhiyu.switchDarkMode()" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/">Python操作记录</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Python/" tabindex="-1"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>Python</span></a><a class="article-meta__tags" href="/tags/pandas/" tabindex="-1"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>pandas</span></a></span></div></div><h1 class="post-title">Python——第7章 pandas数据分析实战</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-06-07T13:38:51.000Z" title="发表于 2023-06-07 21:38:51">2023-06-07</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-07-16T15:24:26.000Z" title="更新于 2023-07-16 23:24:26">2023-07-16</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">19.9k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>91分钟</span></span><span class="post-meta-separator"> </span><span class="post-meta-position" title="作者IP属地为深圳"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>深圳</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="/pageimg/2027105.jpg"></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="pandas常用数据类型">pandas常用数据类型</h1><h2 id="一维数组与常用操作">一维数组与常用操作</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置输出结果对齐方式</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#自动创建从0开始的非负整数索引</span></span><br><span class="line">s1=pd.Series(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">20</span>,<span class="number">5</span>))</span><br><span class="line"><span class="comment">#使用字典创建Series，使用字典的“键”作为索引</span></span><br><span class="line">s2=pd.Series(&#123;<span class="string">&#x27;语文&#x27;</span>:<span class="number">90</span>,<span class="string">&#x27;数学&#x27;</span>:<span class="number">92</span>,<span class="string">&#x27;Python&#x27;</span>:<span class="number">98</span>,<span class="string">&#x27;物理&#x27;</span>:<span class="number">87</span>,<span class="string">&#x27;化学&#x27;</span>:<span class="number">92</span>&#125;)</span><br><span class="line"><span class="comment">#修改指定索引对应的值</span></span><br><span class="line">s1[<span class="number">3</span>]=-<span class="number">17</span></span><br><span class="line">s2[<span class="string">&#x27;语文&#x27;</span>]=<span class="number">94</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;s1原始数据&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(s1)</span><br></pre></td></tr></table></figure><pre><code>s1原始数据==============
0     1
1     6
2    11
3   -17
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;对s1所有数据求绝对值&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">abs</span>(s1))</span><br></pre></td></tr></table></figure><pre><code>对s1所有数据求绝对值=========
0     1
1     6
2    11
3    17
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;s1所有的值加5&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(s1+<span class="number">5</span>)</span><br></pre></td></tr></table></figure><pre><code>s1所有的值加5============
0     6
1    11
2    16
3   -12
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;s1的每行索引前面加上数字2&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(s1.add_prefix(<span class="number">2</span>))</span><br></pre></td></tr></table></figure><pre><code>s1的每行索引前面加上数字2======
20     1
21     6
22    11
23   -17
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;s2原始数据&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(s2)</span><br></pre></td></tr></table></figure><pre><code>s2原始数据==============
语文      94
数学      92
Python    98
物理      87
化学      92
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;s2数据的直方图&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line">s2.hist()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><pre><code>s2数据的直方图============
</code></pre><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/posts/d966146/output_8_1-16861452192801.png" title="output_8_1"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;s2的每行索引后面加上_张三&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(s2.add_suffix(<span class="string">&#x27;_张三&#x27;</span>))</span><br></pre></td></tr></table></figure><pre><code>s2的每行索引后面加上_张三======
语文_张三      94
数学_张三      92
Python_张三    98
物理_张三      87
化学_张三      92
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;s2最大值的索引&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(s2.idxmax())</span><br></pre></td></tr></table></figure><pre><code>s2最大值的索引============
Python
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;测试s2的值是否在指定区间内&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(s2.between(<span class="number">90</span>,<span class="number">94</span>,inclusive=<span class="literal">True</span>))</span><br></pre></td></tr></table></figure><pre><code>测试s2的值是否在指定区间内======
语文       True
数学       True
Python    False
物理      False
化学       True
dtype: bool
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看s2中大于中值的数据&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(s2[s2&gt;s2.median()])</span><br></pre></td></tr></table></figure><pre><code>查看s2中大于中值的数据========
语文      94
Python    98
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看s2中90分以上的数据&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(s2[s2&gt;<span class="number">90</span>])</span><br></pre></td></tr></table></figure><pre><code>查看s2中90分以上的数据=======
语文      94
数学      92
Python    98
化学      92
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;s2与数字之间的运算&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">round</span>((s2**<span class="number">0.5</span>)*<span class="number">10</span>,<span class="number">1</span>))</span><br></pre></td></tr></table></figure><pre><code>s2与数字之间的运算==========
语文      97.0
数学      95.9
Python    99.0
物理      93.3
化学      95.9
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;s2的中值&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(s2.median())</span><br></pre></td></tr></table></figure><pre><code>s2的中值===============
92.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;s2中最小的2个值&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(s2.nsmallest(<span class="number">2</span>))</span><br></pre></td></tr></table></figure><pre><code>s2中最小的2个值===========
物理    87
数学    92
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#两个等长Series对象之间可以进行四则运算和幂运算</span></span><br><span class="line"><span class="comment">#只对两个Series对象中都有的索引对应的值进行计算</span></span><br><span class="line"><span class="comment">#非共同索引对应的值为空值NaN</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;两个Series对象相加&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(pd.Series(<span class="built_in">range</span>(<span class="number">5</span>))+pd.Series(<span class="built_in">range</span>(<span class="number">5</span>,<span class="number">10</span>)))</span><br></pre></td></tr></table></figure><pre><code>两个Series对象相加========
0     5
1     7
2     9
3    11
4    13
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;每个值的平方对5的余数&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(pd.Series(<span class="built_in">range</span>(<span class="number">5</span>)).pipe(<span class="keyword">lambda</span> x,y,z:(x**y)%z,<span class="number">2</span>,<span class="number">5</span>))</span><br></pre></td></tr></table></figure><pre><code>每个值的平方对5的余数=========
0    0
1    1
2    4
3    4
4    1
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;每个值加3之后再乘以3&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(pd.Series(<span class="built_in">range</span>(<span class="number">5</span>)).pipe(<span class="keyword">lambda</span> x:x+<span class="number">3</span>).pipe(<span class="keyword">lambda</span> x:x*<span class="number">3</span>))</span><br></pre></td></tr></table></figure><pre><code>每个值加3之后再乘以3=========
0     9
1    12
2    15
3    18
4    21
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;每个值加3&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(pd.Series(<span class="built_in">range</span>(<span class="number">5</span>)).apply(<span class="keyword">lambda</span> x:x+<span class="number">3</span>))</span><br></pre></td></tr></table></figure><pre><code>每个值加3===============
0    3
1    4
2    5
3    6
4    7
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;标准差、无偏方差、无偏标准差&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(pd.Series(<span class="built_in">range</span>(<span class="number">5</span>)).std())</span><br><span class="line"><span class="built_in">print</span>(pd.Series(<span class="built_in">range</span>(<span class="number">5</span>)).var())</span><br><span class="line"><span class="built_in">print</span>(pd.Series(<span class="built_in">range</span>(<span class="number">5</span>)).sem())</span><br></pre></td></tr></table></figure><pre><code>标准差、无偏方差、无偏标准差======
1.5811388300841898
2.5
0.7071067811865476
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看是否存在等价于True的值&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">any</span>(pd.Series([<span class="number">3</span>,<span class="number">0</span>,<span class="literal">True</span>])))</span><br></pre></td></tr></table></figure><pre><code>查看是否存在等价于True的值=====
True
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看是否所有值都等价于True&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">all</span>(pd.Series([<span class="number">3</span>,<span class="number">0</span>,<span class="literal">True</span>])))</span><br></pre></td></tr></table></figure><pre><code>查看是否所有值都等价于True=====
False
</code></pre><h2 id="时间序列与常用操作">时间序列与常用操作</h2><p>时间序列对象一般使用pandas的date_range()函数生成，可以指定日期时间的起始和结束范围、时间间隔以及数据数量等参数，语法为：</p><p>date_range(start=None, end=None, periods=None,freq=‘D’, tz=None, normalize=False,name=None, closed=None, **kwargs)</p><p>stard指定起始日期，end指定结束日期，periods指定生成的数据数量</p><p>freq指定时间间隔，D表示天，W表示周，H表示小时</p><p>M表示月末最后一天，MS表示月初第一天</p><p>T表示分钟，Y表示年末最后一天，YS表示年初第一天</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;间隔5天&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.date_range(start=<span class="string">&#x27;20190601&#x27;</span>,end=<span class="string">&#x27;20190630&#x27;</span>,freq=<span class="string">&#x27;5D&#x27;</span>))</span><br></pre></td></tr></table></figure><pre><code>间隔5天
DatetimeIndex(['2019-06-01', '2019-06-06', '2019-06-11', '2019-06-16',
               '2019-06-21', '2019-06-26'],
              dtype='datetime64[ns]', freq='5D')
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;间隔1周&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.date_range(start=<span class="string">&#x27;20190601&#x27;</span>,end=<span class="string">&#x27;20190630&#x27;</span>,freq=<span class="string">&#x27;W&#x27;</span>))</span><br></pre></td></tr></table></figure><pre><code>间隔1周
DatetimeIndex(['2019-06-02', '2019-06-09', '2019-06-16', '2019-06-23',
               '2019-06-30'],
              dtype='datetime64[ns]', freq='W-SUN')
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;间隔2天，5个数据&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.date_range(start=<span class="string">&#x27;20190601&#x27;</span>,periods=<span class="number">5</span>,freq=<span class="string">&#x27;2D&#x27;</span>))</span><br></pre></td></tr></table></figure><pre><code>间隔2天，5个数据
DatetimeIndex(['2019-06-01', '2019-06-03', '2019-06-05', '2019-06-07',
               '2019-06-09'],
              dtype='datetime64[ns]', freq='2D')
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;间隔3小时，8个数据&#x27;</span>.ljust(<span class="number">30</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(pd.date_range(start=<span class="string">&#x27;20190601&#x27;</span>,periods=<span class="number">8</span>,freq=<span class="string">&#x27;3H&#x27;</span>))</span><br></pre></td></tr></table></figure><pre><code>间隔3小时，8个数据====================
DatetimeIndex(['2019-06-01 00:00:00', '2019-06-01 03:00:00',
               '2019-06-01 06:00:00', '2019-06-01 09:00:00',
               '2019-06-01 12:00:00', '2019-06-01 15:00:00',
               '2019-06-01 18:00:00', '2019-06-01 21:00:00'],
              dtype='datetime64[ns]', freq='3H')
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;3:00开始，间隔1分钟，12个数据&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.date_range(start=<span class="string">&#x27;201906010300&#x27;</span>,periods=<span class="number">12</span>,freq=<span class="string">&#x27;T&#x27;</span>))</span><br></pre></td></tr></table></figure><pre><code>3:00开始，间隔1分钟，12个数据
DatetimeIndex(['2019-06-01 03:00:00', '2019-06-01 03:01:00',
               '2019-06-01 03:02:00', '2019-06-01 03:03:00',
               '2019-06-01 03:04:00', '2019-06-01 03:05:00',
               '2019-06-01 03:06:00', '2019-06-01 03:07:00',
               '2019-06-01 03:08:00', '2019-06-01 03:09:00',
               '2019-06-01 03:10:00', '2019-06-01 03:11:00'],
              dtype='datetime64[ns]', freq='T')
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;间隔1月，月末最后一天&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.date_range(start=<span class="string">&#x27;20190101&#x27;</span>,end=<span class="string">&#x27;20191231&#x27;</span>,freq=<span class="string">&#x27;M&#x27;</span>))</span><br></pre></td></tr></table></figure><pre><code>间隔1月，月末最后一天
DatetimeIndex(['2019-01-31', '2019-02-28', '2019-03-31', '2019-04-30',
               '2019-05-31', '2019-06-30', '2019-07-31', '2019-08-31',
               '2019-09-30', '2019-10-31', '2019-11-30', '2019-12-31'],
              dtype='datetime64[ns]', freq='M')
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;间隔1年，6个数据，年末最后一天&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.date_range(start=<span class="string">&#x27;20190101&#x27;</span>,periods=<span class="number">6</span>,freq=<span class="string">&#x27;A&#x27;</span>))</span><br></pre></td></tr></table></figure><pre><code>间隔1年，6个数据，年末最后一天
DatetimeIndex(['2019-12-31', '2020-12-31', '2021-12-31', '2022-12-31',
               '2023-12-31', '2024-12-31'],
              dtype='datetime64[ns]', freq='A-DEC')
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;间隔1年，6个数据，年初第一天&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.date_range(start=<span class="string">&#x27;20190101&#x27;</span>,periods=<span class="number">6</span>,freq=<span class="string">&#x27;AS&#x27;</span>))</span><br></pre></td></tr></table></figure><pre><code>间隔1年，6个数据，年初第一天
DatetimeIndex(['2019-01-01', '2020-01-01', '2021-01-01', '2022-01-01',
               '2023-01-01', '2024-01-01'],
              dtype='datetime64[ns]', freq='AS-JAN')
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用日期时间做索引，创建Series对象</span></span><br><span class="line">data=pd.Series(index=pd.date_range(start=<span class="string">&#x27;20190701&#x27;</span>,periods=<span class="number">24</span>,freq=<span class="string">&#x27;H&#x27;</span>),data=<span class="built_in">range</span>(<span class="number">24</span>))</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;前5条数据&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(data[:<span class="number">5</span>])</span><br></pre></td></tr></table></figure><pre><code>前5条数据
2019-07-01 00:00:00    0
2019-07-01 01:00:00    1
2019-07-01 02:00:00    2
2019-07-01 03:00:00    3
2019-07-01 04:00:00    4
Freq: H, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;3小时重采样，计算均值&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(data.resample(<span class="string">&#x27;3H&#x27;</span>).mean())</span><br></pre></td></tr></table></figure><pre><code>3小时重采样，计算均值
2019-07-01 00:00:00     1
2019-07-01 03:00:00     4
2019-07-01 06:00:00     7
2019-07-01 09:00:00    10
2019-07-01 12:00:00    13
2019-07-01 15:00:00    16
2019-07-01 18:00:00    19
2019-07-01 21:00:00    22
Freq: 3H, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;5小时重采样，求和&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(data.resample(<span class="string">&#x27;5H&#x27;</span>).<span class="built_in">sum</span>())</span><br></pre></td></tr></table></figure><pre><code>5小时重采样，求和
2019-07-01 00:00:00    10
2019-07-01 05:00:00    35
2019-07-01 10:00:00    60
2019-07-01 15:00:00    85
2019-07-01 20:00:00    86
Freq: 5H, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;5小时重采样,统计OHLC值&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(data.resample(<span class="string">&#x27;5H&#x27;</span>).ohlc())</span><br></pre></td></tr></table></figure><pre><code>5小时重采样,统计OHLC值
                     open  high  low  close
2019-07-01 00:00:00     0     4    0      4
2019-07-01 05:00:00     5     9    5      9
2019-07-01 10:00:00    10    14   10     14
2019-07-01 15:00:00    15    19   15     19
2019-07-01 20:00:00    20    23   20     23
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;所有日期替换为第二天&#x27;</span>)</span><br><span class="line">data.index=data.index+pd.Timedelta(<span class="string">&#x27;1D&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(data[:<span class="number">5</span>])</span><br></pre></td></tr></table></figure><pre><code>所有日期替换为第二天
2019-07-02 00:00:00    0
2019-07-02 01:00:00    1
2019-07-02 02:00:00    2
2019-07-02 03:00:00    3
2019-07-02 04:00:00    4
Freq: H, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看指定日期是周几&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.Timestamp(<span class="string">&#x27;20190323&#x27;</span>).day_name())</span><br></pre></td></tr></table></figure><pre><code>查看指定日期是周几
Saturday
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看指定日期时间所在年是否为闰年&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.Timestamp(<span class="string">&#x27;201909300800&#x27;</span>).is_leap_year)</span><br></pre></td></tr></table></figure><pre><code>查看指定日期时间所在年是否为闰年
False
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看指定日期所在的季度和月份&#x27;</span>)</span><br><span class="line">day=pd.Timestamp(<span class="string">&#x27;20191025&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(day.quarter,day.month)</span><br></pre></td></tr></table></figure><pre><code>查看指定日期所在的季度和月份
4 10
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;转换为Python的日期时间对象&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(day.to_pydatetime())</span><br></pre></td></tr></table></figure><pre><code>转换为Python的日期时间对象
2019-10-25 00:00:00
</code></pre><h2 id="二维数组dataframe">二维数组DataFrame</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df=pd.DataFrame(np.random.randint(<span class="number">1</span>,<span class="number">20</span>,(<span class="number">5</span>,<span class="number">3</span>)),index=<span class="built_in">range</span>(<span class="number">5</span>),columns=[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><pre><code>    A   B   C
0   9  16   6
1   2  17   1
2   9   5   7
3  16  16  14
4   9  12   1
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">df=pd.DataFrame(np.random.randint(<span class="number">5</span>,<span class="number">15</span>,(<span class="number">13</span>,<span class="number">3</span>)),</span><br><span class="line">                index=pd.date_range(start=<span class="string">&#x27;201907150900&#x27;</span>,</span><br><span class="line">                                    end=<span class="string">&#x27;201907152100&#x27;</span>,</span><br><span class="line">                                    freq=<span class="string">&#x27;H&#x27;</span>),</span><br><span class="line">                columns=[<span class="string">&#x27;熟食&#x27;</span>,<span class="string">&#x27;化妆品&#x27;</span>,<span class="string">&#x27;日用品&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><pre><code>                     熟食  化妆品  日用品
2019-07-15 09:00:00    12      13      10
2019-07-15 10:00:00     6      10       5
2019-07-15 11:00:00     5      13      12
2019-07-15 12:00:00     5       5      12
2019-07-15 13:00:00    13      11      12
2019-07-15 14:00:00     7       6       9
2019-07-15 15:00:00    10      10      13
2019-07-15 16:00:00    14      10       7
2019-07-15 17:00:00    13      14      14
2019-07-15 18:00:00     6      13       9
2019-07-15 19:00:00     7       7      10
2019-07-15 20:00:00     8       9      13
2019-07-15 21:00:00    13      11       5
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df=pd.DataFrame(&#123;<span class="string">&#x27;语文&#x27;</span>:[<span class="number">87</span>,<span class="number">79</span>,<span class="number">67</span>,<span class="number">92</span>],</span><br><span class="line">                 <span class="string">&#x27;数学&#x27;</span>:[<span class="number">93</span>,<span class="number">89</span>,<span class="number">80</span>,<span class="number">77</span>],</span><br><span class="line">                 <span class="string">&#x27;英语&#x27;</span>:[<span class="number">90</span>,<span class="number">80</span>,<span class="number">70</span>,<span class="number">75</span>]&#125;,</span><br><span class="line">                index=[<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;王五&#x27;</span>,<span class="string">&#x27;赵六&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><pre><code>      语文  数学  英语
张三    87    93    90
李四    79    89    80
王五    67    80    70
赵六    92    77    75
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df=pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>:<span class="built_in">range</span>(<span class="number">5</span>,<span class="number">10</span>),<span class="string">&#x27;B&#x27;</span>:<span class="number">3</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><pre><code>   A  B
0  5  3
1  6  3
2  7  3
3  8  3
4  9  3
</code></pre><h1 id="dataframe数据处理与分析实战">DataFrame数据处理与分析实战</h1><h2 id="读取excel文件中的数据">读取Excel文件中的数据</h2><p>read_excel(io, sheetname=0, header=0, skiprows=None, skip_footer=0, index_col=None, names=None, parse_cols=None, parse_dates=False, date_parser=None, na_values=None, thousands=None, convert_float=True, has_index_names=None, converters=None, true_values=None, false_values=None, engine=None, squeeze=False, **kwds)</p><p>1）参数io用来指定要读取的Excel文件，可以是字符串形式的文件路径、url或文件对象；</p><p>2）参数sheetname用来指定要读取的worksheet，可以是表示worksheet序号的整数或表示worksheet名字的字符串，如果要同时读取多个worksheet可以使用形如[0, 1, ‘sheet3’]的列表，如果指定该参数为None则表示读取所有worksheet并返回包含多个DataFrame结构的字典，该参数默认为0（表示读取第一个worksheet中的数据）；</p><p>3）参数headers用来指定worksheet中表示表头或列名的行索引，默认为0，如果没有作为表头的行，必须显式指定headers=None；</p><p>4）参数skiprows用来指定要跳过的行索引组成的列表；</p><p>5）参数index_col用来指定作为DataFrame索引的列下标，可以是包含若干列下标的列表；</p><p>6）参数names用来指定读取数据后使用的列名；</p><p>7）参数thousands用来指定文本转换为数字时的千分符，如果Excel中有以文本形式存储的数字，可以使用该参数；</p><p>8）参数usecols用来指定要读取的列的索引或名字，如果确定字段类型可以使用{‘col’:type}的形式提高速度；</p><p>9）参数na_values用来指定哪些值被解释为缺失值。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df=pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[:<span class="number">10</span>],end=<span class="string">&#x27;\n\n&#x27;</span>)</span><br></pre></td></tr></table></figure><pre><code>   工号  姓名        日期           时段  交易额      柜台
0  1001  张三  2019-03-01   9：00-14：00  1664.0    化妆品
1  1002  李四  2019-03-01  14：00-21：00   954.0    化妆品
2  1003  王五  2019-03-01   9：00-14：00  1407.0      食品
3  1004  赵六  2019-03-01  14：00-21：00  1320.0      食品
4  1005  周七  2019-03-01   9：00-14：00   994.0    日用品
5  1006  钱八  2019-03-01  14：00-21：00  1421.0    日用品
6  1006  钱八  2019-03-01   9：00-14：00  1226.0  蔬菜水果
7  1001  张三  2019-03-01  14：00-21：00  1442.0  蔬菜水果
8  1001  张三  2019-03-02   9：00-14：00  1530.0    化妆品
9  1002  李四  2019-03-02  14：00-21：00  1395.0    化妆品
</code></pre><p>​</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df1=pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>,skiprows=[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>],index_col=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(df1[:<span class="number">10</span>])</span><br></pre></td></tr></table></figure><pre><code>      工号        日期           时段  交易额      柜台
姓名                                                   
李四  1002  2019-03-01  14：00-21：00   954.0    化妆品
赵六  1004  2019-03-01  14：00-21：00  1320.0      食品
钱八  1006  2019-03-01  14：00-21：00  1421.0    日用品
钱八  1006  2019-03-01   9：00-14：00  1226.0  蔬菜水果
张三  1001  2019-03-01  14：00-21：00  1442.0  蔬菜水果
张三  1001  2019-03-02   9：00-14：00  1530.0    化妆品
李四  1002  2019-03-02  14：00-21：00  1395.0    化妆品
王五  1003  2019-03-02   9：00-14：00   936.0      食品
赵六  1004  2019-03-02  14：00-21：00   906.0      食品
周七  1005  2019-03-02   9：00-14：00  1444.0    日用品
</code></pre><h2 id="筛选符合特定条件的数据">筛选符合特定条件的数据</h2><p>DataFrame的索引或切片有四大类：</p><p>索引单元素：基于标签的at、基于位置的iat</p><p>切片columns：用.来切片单列、用[]来切片单列或多列、基于标签的loc、基于位置的iloc</p><p>切片index：用[]来切片单行或多行、基于标签的loc、基于位置的iloc</p><p>切片index和columns：基于标签的loc、基于位置的iloc</p><p>总体规律，基于标签就用at和loc，基于位置就用iat和iloc。</p><h3 id="基于标签at">基于标签at</h3><p>at()根据行列的名称，查询对应值。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df.at[<span class="number">2</span>,<span class="string">&#x27;交易额&#x27;</span>])</span><br></pre></td></tr></table></figure><pre><code>1407.0
</code></pre><h3 id="基于位置iat">基于位置iat</h3><p>iat()根据行列的位置编号，查询对应的值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df.iat[<span class="number">2</span>,<span class="number">5</span>])</span><br></pre></td></tr></table></figure><pre><code>食品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.info()</span><br></pre></td></tr></table></figure><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 249 entries, 0 to 248
Data columns (total 6 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   工号      249 non-null    int64  
 1   姓名      249 non-null    object 
 2   日期      249 non-null    object 
 3   时段      249 non-null    object 
 4   交易额     246 non-null    float64
 5   柜台      249 non-null    object 
dtypes: float64(1), int64(1), object(4)
memory usage: 11.8+ KB
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.describe()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>工号</th><th>交易额</th></tr></thead><tbody><tr><th>count</th><td>249.000000</td><td>246.000000</td></tr><tr><th>mean</th><td>1003.469880</td><td>1330.313008</td></tr><tr><th>std</th><td>1.668039</td><td>904.300720</td></tr><tr><th>min</th><td>1001.000000</td><td>53.000000</td></tr><tr><th>25%</th><td>1002.000000</td><td>1031.250000</td></tr><tr><th>50%</th><td>1003.000000</td><td>1259.000000</td></tr><tr><th>75%</th><td>1005.000000</td><td>1523.000000</td></tr><tr><th>max</th><td>1006.000000</td><td>12100.000000</td></tr></tbody></table></div><h3 id="单列的选取">单列的选取</h3><p>如果追求简洁和方便，用.和[]；如果追求一致和清晰，用loc和iloc</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1[<span class="string">&#x27;交易额&#x27;</span>]</span><br></pre></td></tr></table></figure><pre><code>姓名
李四     954.0
赵六    1320.0
钱八    1421.0
钱八    1226.0
张三    1442.0
         ...  
李四     859.0
赵六    1668.0
赵六    1722.0
王五    1274.0
钱八     812.0
Name: 交易额, Length: 246, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.loc[:,<span class="string">&#x27;交易额&#x27;</span>]</span><br></pre></td></tr></table></figure><pre><code>姓名
李四     954.0
赵六    1320.0
钱八    1421.0
钱八    1226.0
张三    1442.0
         ...  
李四     859.0
赵六    1668.0
赵六    1722.0
王五    1274.0
钱八     812.0
Name: 交易额, Length: 246, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.交易额</span><br></pre></td></tr></table></figure><pre><code>姓名
李四     954.0
赵六    1320.0
钱八    1421.0
钱八    1226.0
张三    1442.0
         ...  
李四     859.0
赵六    1668.0
赵六    1722.0
王五    1274.0
钱八     812.0
Name: 交易额, Length: 246, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.iloc[:,<span class="number">3</span>]</span><br></pre></td></tr></table></figure><pre><code>姓名
李四     954.0
赵六    1320.0
钱八    1421.0
钱八    1226.0
张三    1442.0
         ...  
李四     859.0
赵六    1668.0
赵六    1722.0
王五    1274.0
钱八     812.0
Name: 交易额, Length: 246, dtype: float64
</code></pre><h3 id="多列的选取">多列的选取</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df[[<span class="string">&#x27;姓名&#x27;</span>,<span class="string">&#x27;日期&#x27;</span>,<span class="string">&#x27;柜台&#x27;</span>]])</span><br></pre></td></tr></table></figure><pre><code>     姓名        日期      柜台
0    张三  2019-03-01    化妆品
1    李四  2019-03-01    化妆品
2    王五  2019-03-01      食品
3    赵六  2019-03-01      食品
4    周七  2019-03-01    日用品
..    ...         ...       ...
244  李四  2019-03-31  蔬菜水果
245  赵六  2019-03-31    日用品
246  赵六  2019-03-31    日用品
247  王五  2019-03-31      食品
248  钱八  2019-03-31      食品

[249 rows x 3 columns]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df.loc[:,[<span class="string">&#x27;姓名&#x27;</span>,<span class="string">&#x27;交易额&#x27;</span>]])</span><br></pre></td></tr></table></figure><pre><code>     姓名  交易额
0    张三  1664.0
1    李四   954.0
2    王五  1407.0
3    赵六  1320.0
4    周七   994.0
..    ...     ...
244  李四   859.0
245  赵六  1668.0
246  赵六  1722.0
247  王五  1274.0
248  钱八   812.0

[249 rows x 2 columns]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df.iloc[:,<span class="number">0</span>:<span class="number">2</span>])</span><br></pre></td></tr></table></figure><pre><code>     工号  姓名
0    1001  张三
1    1002  李四
2    1003  王五
3    1004  赵六
4    1005  周七
..    ...   ...
244  1002  李四
245  1004  赵六
246  1004  赵六
247  1003  王五
248  1006  钱八

[249 rows x 2 columns]
</code></pre><h3 id="单行的选取">单行的选取</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df.iloc[<span class="number">5</span>])</span><br></pre></td></tr></table></figure><pre><code>工号               1006
姓名               钱八
日期         2019-03-01
时段      14：00-21：00
交易额           1421.0
柜台             日用品
Name: 5, dtype: object
</code></pre><h3 id="多行的选取">多行的选取</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df[<span class="number">5</span>:<span class="number">11</span>])</span><br></pre></td></tr></table></figure><pre><code>    工号  姓名        日期           时段  交易额      柜台
5   1006  钱八  2019-03-01  14：00-21：00  1421.0    日用品
6   1006  钱八  2019-03-01   9：00-14：00  1226.0  蔬菜水果
7   1001  张三  2019-03-01  14：00-21：00  1442.0  蔬菜水果
8   1001  张三  2019-03-02   9：00-14：00  1530.0    化妆品
9   1002  李四  2019-03-02  14：00-21：00  1395.0    化妆品
10  1003  王五  2019-03-02   9：00-14：00   936.0      食品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df.loc[<span class="number">0</span>:<span class="number">5</span>,:])</span><br></pre></td></tr></table></figure><pre><code>   工号  姓名        日期           时段  交易额    柜台
0  1001  张三  2019-03-01   9：00-14：00  1664.0  化妆品
1  1002  李四  2019-03-01  14：00-21：00   954.0  化妆品
2  1003  王五  2019-03-01   9：00-14：00  1407.0    食品
3  1004  赵六  2019-03-01  14：00-21：00  1320.0    食品
4  1005  周七  2019-03-01   9：00-14：00   994.0  日用品
5  1006  钱八  2019-03-01  14：00-21：00  1421.0  日用品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df1.iloc[[<span class="number">3</span>,<span class="number">5</span>,<span class="number">10</span>],:])</span><br></pre></td></tr></table></figure><pre><code>      工号        日期           时段  交易额      柜台
姓名                                                   
钱八  1006  2019-03-01   9：00-14：00  1226.0  蔬菜水果
张三  1001  2019-03-02   9：00-14：00  1530.0    化妆品
钱八  1006  2019-03-02  14：00-21：00  1141.0    日用品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df[[<span class="string">&#x27;姓名&#x27;</span>,<span class="string">&#x27;交易额&#x27;</span>]])</span><br></pre></td></tr></table></figure><pre><code>     姓名  交易额
0    张三  1664.0
1    李四   954.0
2    王五  1407.0
3    赵六  1320.0
4    周七   994.0
..    ...     ...
244  李四   859.0
245  赵六  1668.0
246  赵六  1722.0
247  王五  1274.0
248  钱八   812.0

[249 rows x 2 columns]
</code></pre><h3 id="块的选取">块的选取</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df1.iloc[[<span class="number">3</span>,<span class="number">5</span>,<span class="number">10</span>],[<span class="number">0</span>,<span class="number">1</span>,<span class="number">4</span>]])</span><br></pre></td></tr></table></figure><pre><code>      工号        日期      柜台
姓名                            
钱八  1006  2019-03-01  蔬菜水果
张三  1001  2019-03-02    化妆品
钱八  1006  2019-03-02    日用品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df[[<span class="string">&#x27;姓名&#x27;</span>,<span class="string">&#x27;日期&#x27;</span>,<span class="string">&#x27;柜台&#x27;</span>]][:<span class="number">5</span>])</span><br></pre></td></tr></table></figure><pre><code>   姓名        日期    柜台
0  张三  2019-03-01  化妆品
1  李四  2019-03-01  化妆品
2  王五  2019-03-01    食品
3  赵六  2019-03-01    食品
4  周七  2019-03-01  日用品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df.loc[[<span class="number">3</span>,<span class="number">5</span>,<span class="number">10</span>],[<span class="string">&#x27;姓名&#x27;</span>,<span class="string">&#x27;交易额&#x27;</span>]])</span><br></pre></td></tr></table></figure><pre><code>    姓名  交易额
3   赵六  1320.0
5   钱八  1421.0
10  王五   936.0
</code></pre><h3 id="根据条件过滤行-布尔索引">根据条件过滤行（布尔索引）</h3><p>布尔索引就是用一个由布尔类型值组成的数组来选择元素的方法。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df[df[<span class="string">&#x27;交易额&#x27;</span>]&gt;<span class="number">1700</span>])</span><br></pre></td></tr></table></figure><pre><code>     工号  姓名        日期           时段   交易额      柜台
18   1003  王五  2019-03-03   9：00-14：00   1713.0      食品
47   1005  周七  2019-03-06  14：00-21：00   1778.0  蔬菜水果
48   1003  王五  2019-03-07   9：00-14：00   1713.0    化妆品
82   1006  钱八  2019-03-11   9：00-14：00   1737.0      食品
105  1001  张三  2019-03-14   9：00-14：00  12100.0    日用品
113  1002  李四  2019-03-15   9：00-14：00   1798.0    日用品
121  1002  李四  2019-03-16   9：00-14：00   1788.0    日用品
136  1001  张三  2019-03-17  14：00-21：00   1791.0      食品
185  1004  赵六  2019-03-24   9：00-14：00   1775.0    化妆品
188  1002  李四  2019-03-24  14：00-21：00   1793.0  蔬菜水果
205  1001  张三  2019-03-26   9：00-14：00   1746.0    日用品
223  1003  王五  2019-03-28   9：00-14：00   9031.0      食品
227  1005  周七  2019-03-29   9：00-14：00   1737.0  蔬菜水果
246  1004  赵六  2019-03-31  14：00-21：00   1722.0    日用品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;张三下午班的交易情况&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[df[<span class="string">&#x27;时段&#x27;</span>]==<span class="string">&#x27;14：00-21：00&#x27;</span>][:<span class="number">10</span>])</span><br></pre></td></tr></table></figure><pre><code>张三下午班的交易情况
    工号  姓名        日期           时段  交易额      柜台
1   1002  李四  2019-03-01  14：00-21：00   954.0    化妆品
3   1004  赵六  2019-03-01  14：00-21：00  1320.0      食品
5   1006  钱八  2019-03-01  14：00-21：00  1421.0    日用品
7   1001  张三  2019-03-01  14：00-21：00  1442.0  蔬菜水果
9   1002  李四  2019-03-02  14：00-21：00  1395.0    化妆品
11  1004  赵六  2019-03-02  14：00-21：00   906.0      食品
13  1006  钱八  2019-03-02  14：00-21：00  1141.0    日用品
15  1003  王五  2019-03-02  14：00-21：00  1179.0  蔬菜水果
17  1002  李四  2019-03-03  14：00-21：00  1034.0    化妆品
19  1004  赵六  2019-03-03  14：00-21：00  1236.0      食品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;下午班的交易情况&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[(df.姓名==<span class="string">&#x27;张三&#x27;</span>)&amp;(df.时段==<span class="string">&#x27;14：00-21：00&#x27;</span>)][:<span class="number">10</span>])</span><br></pre></td></tr></table></figure><pre><code>下午班的交易情况
     工号  姓名        日期           时段  交易额      柜台
7    1001  张三  2019-03-01  14：00-21：00  1442.0  蔬菜水果
39   1001  张三  2019-03-05  14：00-21：00   856.0  蔬菜水果
73   1001  张三  2019-03-10  14：00-21：00  1040.0    化妆品
91   1001  张三  2019-03-12  14：00-21：00  1435.0      食品
99   1001  张三  2019-03-13  14：00-21：00  1333.0      食品
112  1001  张三  2019-03-14  14：00-21：00  1261.0  蔬菜水果
120  1001  张三  2019-03-15  14：00-21：00  1035.0  蔬菜水果
128  1001  张三  2019-03-16  14：00-21：00  1408.0  蔬菜水果
136  1001  张三  2019-03-17  14：00-21：00  1791.0      食品
144  1001  张三  2019-03-18  14：00-21：00  1378.0      食品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;张三和李四2人销售总额&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[df[<span class="string">&#x27;姓名&#x27;</span>].isin([<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;李四&#x27;</span>])][<span class="string">&#x27;交易额&#x27;</span>].<span class="built_in">sum</span>())</span><br></pre></td></tr></table></figure><pre><code>张三和李四2人销售总额
116860.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;日用品柜台销售总额&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[df[<span class="string">&#x27;柜台&#x27;</span>]==<span class="string">&#x27;日用品&#x27;</span>][<span class="string">&#x27;交易额&#x27;</span>].<span class="built_in">sum</span>())</span><br></pre></td></tr></table></figure><pre><code>日用品柜台销售总额
88162.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;交易额在指定范围内的记录&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[df[<span class="string">&#x27;交易额&#x27;</span>].between(<span class="number">800</span>,<span class="number">850</span>)])</span><br></pre></td></tr></table></figure><pre><code>交易额在指定范围内的记录
     工号  姓名        日期           时段  交易额      柜台
41   1002  李四  2019-03-06  14：00-21：00   822.0    化妆品
55   1002  李四  2019-03-07  14：00-21：00   831.0  蔬菜水果
59   1004  赵六  2019-03-08  14：00-21：00   825.0      食品
86   1003  王五  2019-03-11   9：00-14：00   801.0  蔬菜水果
94   1003  王五  2019-03-12   9：00-14：00   831.0  蔬菜水果
106  1002  李四  2019-03-14  14：00-21：00   822.0    日用品
129  1002  李四  2019-03-17   9：00-14：00   828.0    日用品
132  1006  钱八  2019-03-17  14：00-21：00   840.0  蔬菜水果
137  1002  李四  2019-03-18   9：00-14：00   824.0    化妆品
147  1003  王五  2019-03-19   9：00-14：00   846.0  蔬菜水果
152  1001  张三  2019-03-19  14：00-21：00   844.0      食品
160  1001  张三  2019-03-20  14：00-21：00   829.0      食品
163  1006  钱八  2019-03-21   9：00-14：00   807.0  蔬菜水果
233  1001  张三  2019-03-30  14：00-21：00   850.0    化妆品
248  1006  钱八  2019-03-31  14：00-21：00   812.0      食品
</code></pre><h3 id="高级索引-多层索引">高级索引（多层索引）</h3><p>用MultiIndex函数创建「多层index」midx和「多层columns」mcol。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">data=[[<span class="string">&#x27;电商&#x27;</span>,<span class="number">101550</span>,<span class="number">176.92</span>,<span class="number">16175610</span>],</span><br><span class="line">[<span class="string">&#x27;电商&#x27;</span>,<span class="number">175336</span>,<span class="number">25.95</span>,<span class="number">27113291</span>],</span><br><span class="line">[<span class="string">&#x27;金融&#x27;</span>,<span class="number">60348</span>,<span class="number">41.79</span>,<span class="number">10132145</span>],</span><br><span class="line">[<span class="string">&#x27;金融&#x27;</span>,<span class="number">36600</span>,<span class="number">196.00</span>,<span class="number">2626634</span>]]</span><br><span class="line">midx=pd.MultiIndex([[<span class="string">&#x27;中国&#x27;</span>,<span class="string">&#x27;美国&#x27;</span>],[<span class="string">&#x27;BABA&#x27;</span>,<span class="string">&#x27;JD&#x27;</span>,<span class="string">&#x27;GS&#x27;</span>,<span class="string">&#x27;MS&#x27;</span>]],</span><br><span class="line">                    [[<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>],[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]],</span><br><span class="line">                    names=[<span class="string">&#x27;地区&#x27;</span>,<span class="string">&#x27;代号&#x27;</span>])</span><br><span class="line">mcol=pd.MultiIndex([[<span class="string">&#x27;公司数据&#x27;</span>,<span class="string">&#x27;交易数据&#x27;</span>],</span><br><span class="line">                        [<span class="string">&#x27;行业&#x27;</span>,<span class="string">&#x27;雇员&#x27;</span>,<span class="string">&#x27;价格&#x27;</span>,<span class="string">&#x27;交易量&#x27;</span>]],</span><br><span class="line">                        [[<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>],[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]],</span><br><span class="line">                        names=[<span class="string">&#x27;概括&#x27;</span>,<span class="string">&#x27;细分&#x27;</span>])</span><br><span class="line">df2=pd.DataFrame(data,index=midx,columns=mcol)</span><br><span class="line">df2</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr><th></th><th>概括</th><th colspan="2" halign="left">公司数据</th><th colspan="2" halign="left">交易数据</th></tr><tr><th></th><th>细分</th><th>行业</th><th>雇员</th><th>价格</th><th>交易量</th></tr><tr><th>地区</th><th>代号</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th rowspan="2" valign="top">中国</th><th>BABA</th><td>电商</td><td>101550</td><td>176.92</td><td>16175610</td></tr><tr><th>JD</th><td>电商</td><td>175336</td><td>25.95</td><td>27113291</td></tr><tr><th rowspan="2" valign="top">美国</th><th>GS</th><td>金融</td><td>60348</td><td>41.79</td><td>10132145</td></tr><tr><th>MS</th><td>金融</td><td>36600</td><td>196.00</td><td>2626634</td></tr></tbody></table></div><p>这个DataFrame的index和columns都有两层，严格来说是个四维数据。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df2.loc[<span class="string">&#x27;中国&#x27;</span>].loc[<span class="string">&#x27;BABA&#x27;</span>:<span class="string">&#x27;JD&#x27;</span>]</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr><th>概括</th><th colspan="2" halign="left">公司数据</th><th colspan="2" halign="left">交易数据</th></tr><tr><th>细分</th><th>行业</th><th>雇员</th><th>价格</th><th>交易量</th></tr><tr><th>代号</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>BABA</th><td>电商</td><td>101550</td><td>176.92</td><td>16175610</td></tr><tr><th>JD</th><td>电商</td><td>175336</td><td>25.95</td><td>27113291</td></tr></tbody></table></div><h3 id="高级索引-调位level">高级索引（调位level）</h3><p>如果你不喜欢index level的顺序，可用swaplevel将它们调位。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df2.swaplevel(<span class="string">&#x27;地区&#x27;</span>,<span class="string">&#x27;代号&#x27;</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr><th></th><th>概括</th><th colspan="2" halign="left">公司数据</th><th colspan="2" halign="left">交易数据</th></tr><tr><th></th><th>细分</th><th>行业</th><th>雇员</th><th>价格</th><th>交易量</th></tr><tr><th>代号</th><th>地区</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>BABA</th><th>中国</th><td>电商</td><td>101550</td><td>176.92</td><td>16175610</td></tr><tr><th>JD</th><th>中国</th><td>电商</td><td>175336</td><td>25.95</td><td>27113291</td></tr><tr><th>GS</th><th>美国</th><td>金融</td><td>60348</td><td>41.79</td><td>10132145</td></tr><tr><th>MS</th><th>美国</th><td>金融</td><td>36600</td><td>196.00</td><td>2626634</td></tr></tbody></table></div><p>如果你不喜欢columns level的顺序，也可用swaplevel将它们调位。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df2.columns=df.columns.swaplevel(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">df2</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr><th></th><th>细分</th><th>行业</th><th>雇员</th><th>价格</th><th>交易量</th></tr><tr><th></th><th>概括</th><th>公司数据</th><th>公司数据</th><th>交易数据</th><th>交易数据</th></tr><tr><th>地区</th><th>代号</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th rowspan="2" valign="top">中国</th><th>BABA</th><td>电商</td><td>101550</td><td>176.92</td><td>16175610</td></tr><tr><th>JD</th><td>电商</td><td>175336</td><td>25.95</td><td>27113291</td></tr><tr><th rowspan="2" valign="top">美国</th><th>GS</th><td>金融</td><td>60348</td><td>41.79</td><td>10132145</td></tr><tr><th>MS</th><td>金融</td><td>36600</td><td>196.00</td><td>2626634</td></tr></tbody></table></div><h3 id="高级索引-重设index">高级索引（重设index）</h3><p>有时候，一个DataFrame的一个或者多个columns适合做index，这时可用set_index将它们设置为index，如果要将index还原成columns，那么用reset_index。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data=&#123;<span class="string">&#x27;地区&#x27;</span>:[<span class="string">&#x27;中国&#x27;</span>,<span class="string">&#x27;中国&#x27;</span>,<span class="string">&#x27;美国&#x27;</span>,<span class="string">&#x27;美国&#x27;</span>],</span><br><span class="line"><span class="string">&#x27;代号&#x27;</span>:[<span class="string">&#x27;BABA&#x27;</span>,<span class="string">&#x27;JD&#x27;</span>,<span class="string">&#x27;MS&#x27;</span>,<span class="string">&#x27;GS&#x27;</span>],</span><br><span class="line"><span class="string">&#x27;行业&#x27;</span>:[<span class="string">&#x27;电商&#x27;</span>,<span class="string">&#x27;电商&#x27;</span>,<span class="string">&#x27;金融&#x27;</span>,<span class="string">&#x27;金融&#x27;</span>],</span><br><span class="line"><span class="string">&#x27;价格&#x27;</span>:[<span class="number">176.92</span>,<span class="number">25.95</span>,<span class="number">41.79</span>,<span class="number">196.00</span>],</span><br><span class="line"><span class="string">&#x27;交易量&#x27;</span>:[<span class="number">16175610</span>,<span class="number">27113291</span>,<span class="number">10132145</span>,<span class="number">2626634</span>],</span><br><span class="line"><span class="string">&#x27;雇员&#x27;</span>:[<span class="number">101550</span>,<span class="number">175336</span>,<span class="number">60348</span>,<span class="number">36600</span>]&#125;</span><br><span class="line">df3=pd.DataFrame(data)</span><br><span class="line">df3</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>地区</th><th>代号</th><th>行业</th><th>价格</th><th>交易量</th><th>雇员</th></tr></thead><tbody><tr><th>0</th><td>中国</td><td>BABA</td><td>电商</td><td>176.92</td><td>16175610</td><td>101550</td></tr><tr><th>1</th><td>中国</td><td>JD</td><td>电商</td><td>25.95</td><td>27113291</td><td>175336</td></tr><tr><th>2</th><td>美国</td><td>MS</td><td>金融</td><td>41.79</td><td>10132145</td><td>60348</td></tr><tr><th>3</th><td>美国</td><td>GS</td><td>金融</td><td>196.00</td><td>2626634</td><td>36600</td></tr></tbody></table></div><p>将「地区」和「代号」设置为第一层index和第二层index。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df4=df3.set_index([<span class="string">&#x27;地区&#x27;</span>,<span class="string">&#x27;代号&#x27;</span>])</span><br><span class="line">df4</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th></th><th>行业</th><th>价格</th><th>交易量</th><th>雇员</th></tr><tr><th>地区</th><th>代号</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th rowspan="2" valign="top">中国</th><th>BABA</th><td>电商</td><td>176.92</td><td>16175610</td><td>101550</td></tr><tr><th>JD</th><td>电商</td><td>25.95</td><td>27113291</td><td>175336</td></tr><tr><th rowspan="2" valign="top">美国</th><th>MS</th><td>金融</td><td>41.79</td><td>10132145</td><td>60348</td></tr><tr><th>GS</th><td>金融</td><td>196.00</td><td>2626634</td><td>36600</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df5=df3.set_index([<span class="string">&#x27;地区&#x27;</span>,<span class="string">&#x27;代号&#x27;</span>])<span class="comment">#将所有index变成columns</span></span><br><span class="line">df5</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th></th><th>行业</th><th>价格</th><th>交易量</th><th>雇员</th></tr><tr><th>地区</th><th>代号</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th rowspan="2" valign="top">中国</th><th>BABA</th><td>电商</td><td>176.92</td><td>16175610</td><td>101550</td></tr><tr><th>JD</th><td>电商</td><td>25.95</td><td>27113291</td><td>175336</td></tr><tr><th rowspan="2" valign="top">美国</th><th>MS</th><td>金融</td><td>41.79</td><td>10132145</td><td>60348</td></tr><tr><th>GS</th><td>金融</td><td>196.00</td><td>2626634</td><td>36600</td></tr></tbody></table></div><h2 id="查看数据特征和统计信息">查看数据特征和统计信息</h2><h3 id="查看数据特征">查看数据特征</h3><p>1.从头或从尾部查看DataFrame的n行，分别用df1.head()和df1.tail(n)，如果没有设定n，默认值为5行。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.head()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>工号</th><th>日期</th><th>时段</th><th>交易额</th><th>柜台</th></tr><tr><th>姓名</th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>李四</th><td>1002</td><td>2019-03-01</td><td>14：00-21：00</td><td>954.0</td><td>化妆品</td></tr><tr><th>赵六</th><td>1004</td><td>2019-03-01</td><td>14：00-21：00</td><td>1320.0</td><td>食品</td></tr><tr><th>钱八</th><td>1006</td><td>2019-03-01</td><td>14：00-21：00</td><td>1421.0</td><td>日用品</td></tr><tr><th>钱八</th><td>1006</td><td>2019-03-01</td><td>9：00-14：00</td><td>1226.0</td><td>蔬菜水果</td></tr><tr><th>张三</th><td>1001</td><td>2019-03-01</td><td>14：00-21：00</td><td>1442.0</td><td>蔬菜水果</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.tail()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>工号</th><th>日期</th><th>时段</th><th>交易额</th><th>柜台</th></tr><tr><th>姓名</th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>李四</th><td>1002</td><td>2019-03-31</td><td>14：00-21：00</td><td>859.0</td><td>蔬菜水果</td></tr><tr><th>赵六</th><td>1004</td><td>2019-03-31</td><td>9：00-14：00</td><td>1668.0</td><td>日用品</td></tr><tr><th>赵六</th><td>1004</td><td>2019-03-31</td><td>14：00-21：00</td><td>1722.0</td><td>日用品</td></tr><tr><th>王五</th><td>1003</td><td>2019-03-31</td><td>9：00-14：00</td><td>1274.0</td><td>食品</td></tr><tr><th>钱八</th><td>1006</td><td>2019-03-31</td><td>14：00-21：00</td><td>812.0</td><td>食品</td></tr></tbody></table></div><ol start="2"><li><a target="_blank" rel="noopener" href="http://df1.info">df1.info</a>()</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.index</span><br></pre></td></tr></table></figure><pre><code>Index(['李四', '赵六', '钱八', '钱八', '张三', '张三', '李四', '王五', '赵六',
       '周七',
       ...
       '王五', '钱八', '周七', '李四', '周七', '李四', '赵六', '赵六', '王五',
       '钱八'],
      dtype='object', name='姓名', length=246)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.columns</span><br></pre></td></tr></table></figure><pre><code>Index(['工号', '日期', '时段', '交易额', '柜台'], dtype='object')
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.values</span><br></pre></td></tr></table></figure><pre><code>array([[1002, '2019-03-01', '14：00-21：00', 954.0, '化妆品'],
       [1004, '2019-03-01', '14：00-21：00', 1320.0, '食品'],
       [1006, '2019-03-01', '14：00-21：00', 1421.0, '日用品'],
       ...,
       [1004, '2019-03-31', '14：00-21：00', 1722.0, '日用品'],
       [1003, '2019-03-31', '9：00-14：00', 1274.0, '食品'],
       [1006, '2019-03-31', '14：00-21：00', 812.0, '食品']], dtype=object)
</code></pre><h3 id="统计特征">统计特征</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看交易统计信息&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;交易额&#x27;</span>].describe())</span><br></pre></td></tr></table></figure><pre><code>查看交易统计信息
count      246.000000
mean      1330.313008
std        904.300720
min         53.000000
25%       1031.250000
50%       1259.000000
75%       1523.000000
max      12100.000000
Name: 交易额, dtype: float64
</code></pre><p>求某列数据最大值及位置、最小值及位置、最大或者最小几条记录</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.describe(percentiles=[<span class="number">.2</span>,<span class="number">.75</span>, <span class="number">.8</span>])</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>工号</th><th>交易额</th></tr></thead><tbody><tr><th>count</th><td>246.000000</td><td>243.000000</td></tr><tr><th>mean</th><td>1003.475610</td><td>1330.008230</td></tr><tr><th>std</th><td>1.667644</td><td>909.365395</td></tr><tr><th>min</th><td>1001.000000</td><td>53.000000</td></tr><tr><th>20%</th><td>1002.000000</td><td>980.400000</td></tr><tr><th>50%</th><td>1003.500000</td><td>1257.000000</td></tr><tr><th>75%</th><td>1005.000000</td><td>1523.000000</td></tr><tr><th>80%</th><td>1005.000000</td><td>1580.200000</td></tr><tr><th>max</th><td>1006.000000</td><td>12100.000000</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;交易额&#x27;</span>].<span class="built_in">sum</span>())</span><br></pre></td></tr></table></figure><pre><code>327257.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;交易额四分位数&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;交易额&#x27;</span>].quantile([<span class="number">0</span>,<span class="number">0.25</span>,<span class="number">0.5</span>,<span class="number">0.75</span>,<span class="number">1</span>]))</span><br></pre></td></tr></table></figure><pre><code>交易额四分位数
0.00       53.00
0.25     1031.25
0.50     1259.00
0.75     1523.00
1.00    12100.00
Name: 交易额, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;交易额中值&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;交易额&#x27;</span>].median())</span><br></pre></td></tr></table></figure><pre><code>交易额中值
1259.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;交易额最小的3条记录&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.nsmallest(<span class="number">3</span>,<span class="string">&#x27;交易额&#x27;</span>))</span><br></pre></td></tr></table></figure><pre><code>交易额最小的3条记录
     工号  姓名        日期           时段  交易额    柜台
76   1005  周七  2019-03-10   9：00-14：00    53.0  日用品
97   1002  李四  2019-03-13  14：00-21：00    98.0  日用品
194  1001  张三  2019-03-25  14：00-21：00   114.0  化妆品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;交易额最大的5条记录&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.nlargest(<span class="number">5</span>,<span class="string">&#x27;交易额&#x27;</span>))</span><br></pre></td></tr></table></figure><pre><code>交易额最大的5条记录
     工号  姓名        日期           时段   交易额      柜台
105  1001  张三  2019-03-14   9：00-14：00  12100.0    日用品
223  1003  王五  2019-03-28   9：00-14：00   9031.0      食品
113  1002  李四  2019-03-15   9：00-14：00   1798.0    日用品
188  1002  李四  2019-03-24  14：00-21：00   1793.0  蔬菜水果
136  1001  张三  2019-03-17  14：00-21：00   1791.0      食品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;最后一个日期&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;日期&#x27;</span>].<span class="built_in">max</span>())</span><br></pre></td></tr></table></figure><pre><code>最后一个日期
2019-03-31
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;最小的工号&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;工号&#x27;</span>].<span class="built_in">min</span>())</span><br></pre></td></tr></table></figure><pre><code>最小的工号
1001
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;第一个最小交易额的行下标&#x27;</span>)</span><br><span class="line">index=df[<span class="string">&#x27;交易额&#x27;</span>].idxmin()</span><br><span class="line"><span class="built_in">print</span>(index)</span><br></pre></td></tr></table></figure><pre><code>第一个最小交易额的行下标
76
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;第一个最小交易额&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.loc[index,<span class="string">&#x27;交易额&#x27;</span>])</span><br></pre></td></tr></table></figure><pre><code>第一个最小交易额
53.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;第一个最大交易额的行下标&#x27;</span>)</span><br><span class="line">index=df[<span class="string">&#x27;交易额&#x27;</span>].idxmax()</span><br><span class="line"><span class="built_in">print</span>(index)</span><br></pre></td></tr></table></figure><pre><code>第一个最大交易额的行下标
105
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;第一个最大的交易额&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.loc[index,<span class="string">&#x27;交易额&#x27;</span>])</span><br></pre></td></tr></table></figure><pre><code>第一个最大的交易额
12100.0
</code></pre><h2 id="按不同标准对数据排序">按不同标准对数据排序</h2><h3 id="sort-values">sort_values()</h3><p>DataFrame.sort_values(by=’’, axis=0, ascending=True, inplace=False, kind=‘quicksort’, na_position=‘last’, ignore_index=False, key=None)</p><p>by:指定要进行排序的列名或索引值</p><p>axis:若 axis=0 或 ‘index’，则按照指定 列 的数据大小排序；若 axis=1 或 ‘columns’，则按照指定 索引 中数据大小排序。默认axis=0</p><p>ascending:若 ascending=True，则按照升序排序；若 ascending=False，则按降序排序，默认为True，即升序排序。如果这是一个 bool 列表，则必须匹配 by 的长度</p><p>inplace:排序后的数据是否替换原来的数据，默认为False，即不替换</p><p>ignore_index:是否重置索引，默认为不重置</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df=pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;按交易额和工号降序排序&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.sort_values(by=[<span class="string">&#x27;交易额&#x27;</span>,<span class="string">&#x27;工号&#x27;</span>],ascending=<span class="literal">False</span>)[:<span class="number">12</span>])</span><br></pre></td></tr></table></figure><pre><code>按交易额和工号降序排序
     工号  姓名        日期           时段   交易额      柜台
105  1001  张三  2019-03-14   9：00-14：00  12100.0    日用品
223  1003  王五  2019-03-28   9：00-14：00   9031.0      食品
113  1002  李四  2019-03-15   9：00-14：00   1798.0    日用品
188  1002  李四  2019-03-24  14：00-21：00   1793.0  蔬菜水果
136  1001  张三  2019-03-17  14：00-21：00   1791.0      食品
121  1002  李四  2019-03-16   9：00-14：00   1788.0    日用品
47   1005  周七  2019-03-06  14：00-21：00   1778.0  蔬菜水果
185  1004  赵六  2019-03-24   9：00-14：00   1775.0    化妆品
205  1001  张三  2019-03-26   9：00-14：00   1746.0    日用品
82   1006  钱八  2019-03-11   9：00-14：00   1737.0      食品
227  1005  周七  2019-03-29   9：00-14：00   1737.0  蔬菜水果
246  1004  赵六  2019-03-31  14：00-21：00   1722.0    日用品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;按交易额降序、工号升序排序&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.sort_values(by=[<span class="string">&#x27;交易额&#x27;</span>,<span class="string">&#x27;工号&#x27;</span>],ascending=[<span class="literal">False</span>,<span class="literal">True</span>])[:<span class="number">12</span>])</span><br></pre></td></tr></table></figure><pre><code>按交易额降序、工号升序排序
     工号  姓名        日期           时段   交易额      柜台
105  1001  张三  2019-03-14   9：00-14：00  12100.0    日用品
223  1003  王五  2019-03-28   9：00-14：00   9031.0      食品
113  1002  李四  2019-03-15   9：00-14：00   1798.0    日用品
188  1002  李四  2019-03-24  14：00-21：00   1793.0  蔬菜水果
136  1001  张三  2019-03-17  14：00-21：00   1791.0      食品
121  1002  李四  2019-03-16   9：00-14：00   1788.0    日用品
47   1005  周七  2019-03-06  14：00-21：00   1778.0  蔬菜水果
185  1004  赵六  2019-03-24   9：00-14：00   1775.0    化妆品
205  1001  张三  2019-03-26   9：00-14：00   1746.0    日用品
227  1005  周七  2019-03-29   9：00-14：00   1737.0  蔬菜水果
82   1006  钱八  2019-03-11   9：00-14：00   1737.0      食品
246  1004  赵六  2019-03-31  14：00-21：00   1722.0    日用品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;按工号升序排序&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.sort_values(by=<span class="string">&#x27;工号&#x27;</span>,na_position=<span class="string">&#x27;last&#x27;</span>)[:<span class="number">10</span>])</span><br></pre></td></tr></table></figure><pre><code>按工号升序排序
     工号  姓名        日期           时段  交易额      柜台
0    1001  张三  2019-03-01   9：00-14：00  1664.0    化妆品
178  1001  张三  2019-03-23  14：00-21：00  1271.0    化妆品
39   1001  张三  2019-03-05  14：00-21：00   856.0  蔬菜水果
40   1001  张三  2019-03-06   9：00-14：00  1037.0    化妆品
177  1001  张三  2019-03-23   9：00-14：00  1296.0    化妆品
169  1001  张三  2019-03-22   9：00-14：00   946.0    化妆品
160  1001  张三  2019-03-20  14：00-21：00   829.0      食品
54   1001  张三  2019-03-07   9：00-14：00  1263.0  蔬菜水果
157  1001  张三  2019-03-20   9：00-14：00  1037.0    日用品
225  1001  张三  2019-03-29  14：00-21：00  1523.0    化妆品
</code></pre><h3 id="sort-index">sort.index()</h3><p>DataFrame.sort_index(axis=0, level=None, ascending=True, inplace=False, kind=’quicksort’, na_position=’last’, sort_remaining=True, by=None)</p><p>axis:索引，直接排序的列</p><p>level:如果不是，则对指定索引级别的值进行排序</p><p>ascending:升序与降序排序</p><p>inplace:如果为True，则就地执行操作</p><p>kind:{“快速排序”，“合并排序”，“堆排序”}，默认为“快速排序”。选择排序算法。有关更多信息，另请参见ndarray.np.sort。 mergesort是唯一稳定的算法。对于DataFrame，此选项仅在对单个列或标签进行排序时适用。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;按列名升序排序&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.sort_index(axis=<span class="number">1</span>,ascending=<span class="literal">True</span>)[:<span class="number">10</span>])</span><br></pre></td></tr></table></figure><pre><code>按列名升序排序
   交易额  姓名  工号        日期           时段      柜台
0  1664.0  张三  1001  2019-03-01   9：00-14：00    化妆品
1   954.0  李四  1002  2019-03-01  14：00-21：00    化妆品
2  1407.0  王五  1003  2019-03-01   9：00-14：00      食品
3  1320.0  赵六  1004  2019-03-01  14：00-21：00      食品
4   994.0  周七  1005  2019-03-01   9：00-14：00    日用品
5  1421.0  钱八  1006  2019-03-01  14：00-21：00    日用品
6  1226.0  钱八  1006  2019-03-01   9：00-14：00  蔬菜水果
7  1442.0  张三  1001  2019-03-01  14：00-21：00  蔬菜水果
8  1530.0  张三  1001  2019-03-02   9：00-14：00    化妆品
9  1395.0  李四  1002  2019-03-02  14：00-21：00    化妆品
</code></pre><h2 id="使用分组与聚合对员工业绩进行汇总">使用分组与聚合对员工业绩进行汇总</h2><p>groupby(by=None, axis=0, level=None, as_index=True, sort=True, group_keys=True, squeeze=False, **kwargs)</p><p>参数by用来指定作用于index的函数、字典、Series对象，或者指定列名作为分组依据；</p><p>参数as_index=False时用来分组的列中的数据不作为结果DataFrame对象的index；</p><p>参数squeeze=True时会在可能的情况下降低结果对象的维度。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;指定by参数为字典&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.groupby(by=&#123;<span class="number">7</span>:<span class="string">&#x27;下标为7的行&#x27;</span>, </span><br><span class="line">                     <span class="number">35</span>:<span class="string">&#x27;下标为35的行&#x27;</span>&#125;)[<span class="string">&#x27;交易额&#x27;</span>].<span class="built_in">sum</span>())</span><br></pre></td></tr></table></figure><pre><code>指定by参数为字典
下标为35的行     974.0
下标为7的行     1442.0
Name: 交易额, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;不同时段的销售总额&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.groupby(by=<span class="string">&#x27;时段&#x27;</span>)[<span class="string">&#x27;交易额&#x27;</span>].<span class="built_in">sum</span>()) </span><br></pre></td></tr></table></figure><pre><code>不同时段的销售总额
时段
14：00-21：00    151228.0
9：00-14：00     176029.0
Name: 交易额, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;各柜台的销售总额&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.groupby(by=<span class="string">&#x27;柜台&#x27;</span>)[<span class="string">&#x27;交易额&#x27;</span>].<span class="built_in">sum</span>())</span><br></pre></td></tr></table></figure><pre><code>各柜台的销售总额
柜台
化妆品      75389.0
日用品      88162.0
蔬菜水果    78532.0
食品        85174.0
Name: 交易额, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#可以查看每个员工上班总时长是否均匀 </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;每个员工上班的次数&#x27;</span>)</span><br><span class="line">dff=df.groupby(by=<span class="string">&#x27;姓名&#x27;</span>)[<span class="string">&#x27;日期&#x27;</span>].count()</span><br><span class="line">dff.name =<span class="string">&#x27;上班次数&#x27;</span> </span><br><span class="line"><span class="built_in">print</span>(dff) </span><br></pre></td></tr></table></figure><pre><code>每个员工上班的次数
姓名
周七    42
张三    38
李四    47
王五    40
赵六    45
钱八    37
Name: 上班次数, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;汇总交易额转换为整数&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.groupby(by=<span class="string">&#x27;姓名&#x27;</span>).<span class="built_in">sum</span>()[<span class="string">&#x27;交易额&#x27;</span>].apply(<span class="built_in">int</span>))</span><br></pre></td></tr></table></figure><pre><code>汇总交易额转换为整数
姓名
周七    47818
张三    58130
李四    58730
王五    58892
赵六    56069
钱八    47618
Name: 交易额, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;每个员工交易额的史值&#x27;</span>) </span><br><span class="line">dff=df.groupby(by=<span class="string">&#x27;姓名&#x27;</span>).median() </span><br><span class="line"><span class="built_in">print</span>(dff[<span class="string">&#x27;交易额&#x27;</span>])</span><br></pre></td></tr></table></figure><pre><code>每个员工交易额的史值
姓名
周七    1134.5
张三    1290.0
李四    1276.0
王五    1227.0
赵六    1224.0
钱八    1381.0
Name: 交易额, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dff[<span class="string">&#x27;排名&#x27;</span>] = dff[<span class="string">&#x27;交易额&#x27;</span>].rank(ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;每个员工交易额中值的排名&#x27;</span>) </span><br><span class="line"><span class="built_in">print</span>(dff[[<span class="string">&#x27;交易额&#x27;</span>,<span class="string">&#x27;排名&#x27;</span>]])</span><br></pre></td></tr></table></figure><pre><code>每个员工交易额中值的排名
      交易额  排名
姓名              
周七  1134.5   6.0
张三  1290.0   2.0
李四  1276.0   3.0
王五  1227.0   4.0
赵六  1224.0   5.0
钱八  1381.0   1.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;每个员工不同时段的交易额&#x27;</span>) </span><br><span class="line"><span class="built_in">print</span>(df.groupby(by=[<span class="string">&#x27;姓名&#x27;</span>,<span class="string">&#x27;时段&#x27;</span>])[<span class="string">&#x27;交易额&#x27;</span>].<span class="built_in">sum</span>()) </span><br></pre></td></tr></table></figure><pre><code>每个员工不同时段的交易额
姓名  时段       
周七  14：00-21：00    15910.0
      9：00-14：00     31908.0
张三  14：00-21：00    23659.0
      9：00-14：00     34471.0
李四  14：00-21：00    32295.0
      9：00-14：00     26435.0
王五  14：00-21：00    17089.0
      9：00-14：00     41803.0
赵六  14：00-21：00    29121.0
      9：00-14：00     26948.0
钱八  14：00-21：00    33154.0
      9：00-14：00     14464.0
Name: 交易额, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#对不同的列可以采用不同的函数 </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;时段和交易额采用不同的聚合方式&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.groupby(by=[<span class="string">&#x27;姓名&#x27;</span>])[<span class="string">&#x27;时段&#x27;</span>,<span class="string">&#x27;交易额&#x27;</span>].aggregate(&#123;<span class="string">&#x27;交易额&#x27;</span>:np.<span class="built_in">sum</span>,</span><br><span class="line">                                                   <span class="string">&#x27;时段&#x27;</span>:<span class="keyword">lambda</span> x:<span class="string">&#x27;各时段累计&#x27;</span>&#125;))</span><br></pre></td></tr></table></figure><pre><code>时段和交易额采用不同的聚合方式
       交易额        时段
姓名                     
周七  47818.0  各时段累计
张三  58130.0  各时段累计
李四  58730.0  各时段累计
王五  58892.0  各时段累计
赵六  56069.0  各时段累计
钱八  47618.0  各时段累计
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用DataErame结构的agg（）方法对指定列进行聚合 </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;使用agg()方法对交易额进行聚合&#x27;</span>) </span><br><span class="line"><span class="built_in">print</span>(df.agg(&#123;<span class="string">&#x27;交易额&#x27;</span>:[<span class="string">&#x27;sum&#x27;</span>,<span class="string">&#x27;mean&#x27;</span>,<span class="string">&#x27;min&#x27;</span>,<span class="string">&#x27;max&#x27;</span>,<span class="string">&#x27;median&#x27;</span>],</span><br><span class="line">              <span class="string">&#x27;日期&#x27;</span>:[<span class="string">&#x27;min&#x27;</span>,<span class="string">&#x27;max&#x27;</span>]&#125;)) </span><br></pre></td></tr></table></figure><pre><code>使用agg()方法对交易额进行聚合
               交易额        日期
sum     327257.000000         NaN
mean      1330.313008         NaN
min         53.000000  2019-03-01
max      12100.000000  2019-03-31
median    1259.000000         NaN
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;对分组结果进行聚合&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看分组聚合后的部分结果&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.groupby(by=<span class="string">&#x27;姓名&#x27;</span>).agg([<span class="string">&#x27;max&#x27;</span>,<span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;median&#x27;</span>])[<span class="string">&#x27;交易额&#x27;</span>])</span><br></pre></td></tr></table></figure><pre><code>对分组结果进行聚合
查看分组聚合后的部分结果
          max    min         mean  median
姓名                                     
周七   1778.0   53.0  1195.450000  1134.5
张三  12100.0  114.0  1529.736842  1290.0
李四   1798.0   98.0  1249.574468  1276.0
王五   9031.0  801.0  1472.300000  1227.0
赵六   1775.0  825.0  1245.977778  1224.0
钱八   1737.0  807.0  1322.722222  1381.0
</code></pre><h2 id="数据的异常值处理">数据的异常值处理</h2><p>异常值是指严重超出正常范围的数值，这样的数据一般是数据采集错误或类似原因引起的。</p><p>在数据分析时，需要把这些数据删除或替换为特定的值（例如人为设定的正常范围边界值），减小对最终数据分析结果的影响。</p><p>异常值处理的关键是根据实际情况准确定义正常范围边界值，超出正常范围的数值认为是异常值。</p><p>1.基于统计与数据发布 2.箱形图分析</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看交易额低于200的数据&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[df.交易额&lt;<span class="number">200</span>])</span><br></pre></td></tr></table></figure><pre><code>查看交易额低于200的数据
     工号  姓名        日期           时段  交易额    柜台
76   1005  周七  2019-03-10   9：00-14：00    53.0  日用品
97   1002  李四  2019-03-13  14：00-21：00    98.0  日用品
194  1001  张三  2019-03-25  14：00-21：00   114.0  化妆品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df.loc[df.交易额&lt;<span class="number">200</span>,<span class="string">&#x27;交易额&#x27;</span>] = df[df.交易额&lt;<span class="number">200</span>][<span class="string">&#x27;交易额&#x27;</span>].<span class="built_in">map</span>(<span class="keyword">lambda</span> num:num*<span class="number">1.5</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;上浮50%之后仍低于200的数据&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[df.交易额&lt;<span class="number">200</span>])</span><br></pre></td></tr></table></figure><pre><code>上浮50%之后仍低于200的数据
     工号  姓名        日期           时段  交易额    柜台
76   1005  周七  2019-03-10   9：00-14：00    79.5  日用品
97   1002  李四  2019-03-13  14：00-21：00   147.0  日用品
194  1001  张三  2019-03-25  14：00-21：00   171.0  化妆品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看交易额高于3000的数据&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[df[<span class="string">&#x27;交易额&#x27;</span>]&gt;<span class="number">3000</span>])</span><br></pre></td></tr></table></figure><pre><code>查看交易额高于3000的数据
     工号  姓名        日期          时段   交易额    柜台
105  1001  张三  2019-03-14  9：00-14：00  12100.0  日用品
223  1003  王五  2019-03-28  9：00-14：00   9031.0    食品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;交易额低于200或高于3000的数据&#x27;</span>) </span><br><span class="line"><span class="built_in">print</span>(df[(df.交易额&lt;<span class="number">200</span>)|(df.交易额&gt;<span class="number">3000</span>)]) </span><br></pre></td></tr></table></figure><pre><code>交易额低于200或高于3000的数据
     工号  姓名        日期           时段   交易额    柜台
76   1005  周七  2019-03-10   9：00-14：00     79.5  日用品
97   1002  李四  2019-03-13  14：00-21：00    147.0  日用品
105  1001  张三  2019-03-14   9：00-14：00  12100.0  日用品
194  1001  张三  2019-03-25  14：00-21：00    171.0  化妆品
223  1003  王五  2019-03-28   9：00-14：00   9031.0    食品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#把低于200的交易额都替换为固定的200 </span></span><br><span class="line">df.loc[df.交易额&lt;<span class="number">200</span>,<span class="string">&#x27;交易额&#x27;</span>]=<span class="number">200</span> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;交易额低于200或高于3000的数据&#x27;</span>) </span><br><span class="line"><span class="built_in">print</span>(df[(df.交易额&lt;<span class="number">200</span>)|(df.交易额&gt;<span class="number">3000</span>)]) </span><br></pre></td></tr></table></figure><pre><code>交易额低于200或高于3000的数据
     工号  姓名        日期          时段   交易额    柜台
105  1001  张三  2019-03-14  9：00-14：00  12100.0  日用品
223  1003  王五  2019-03-28  9：00-14：00   9031.0    食品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">#把高于3000的交易额都替换为固定的３000 </span></span><br><span class="line">df.loc[df.交易额&gt;<span class="number">3000</span>,<span class="string">&#x27;交易额&#x27;</span>]=<span class="number">3000</span> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;交易额低于200或高于3000的数量&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[(df.交易额&lt;<span class="number">200</span>)|(df.交易额&gt;<span class="number">3000</span>)][<span class="string">&#x27;交易额&#x27;</span>].count())</span><br></pre></td></tr></table></figure><pre><code>交易额低于200或高于3000的数量
0
</code></pre><h2 id="处理超市交易额数据中的缺失值">处理超市交易额数据中的缺失值</h2><p>dropna(axis=0, how=‘any’, thresh=None, subset=None, inplace=False)</p><p>参数how='any’时表示只要某行包含缺失值就丢弃，how='all’时表示某行全部为缺失值才丢弃；</p><p>参数thresh用来指定保留包含几个非缺失值数据的行；</p><p>参数subset用来指定在判断缺失值时只考虑哪些列。</p><p>fillna(value=None, method=None, axis=None, inplace=False, limit=None, downcast=None, **kwargs)</p><p>参数value用来指定要替换的值，可以是标量、字典、Series或DataFrame；</p><p>参数method用来指定填充缺失值的方式，值为’pad’或’ffill’时表示使用扫描过程中遇到的最后一个有效值一直填充到下一个有效值，值为’backfill’或’bfill’时表示使用缺失值之后遇到的第一个有效值填充前面遇到的所有连续缺失值；</p><p>参数limit用来指定设置了参数method时最多填充多少个连续的缺失值；</p><p>参数inplace=True时表示原地替换，inplace=False时返回一个新的DataFrame对象而不对原来的DataFrame做任何修改。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df=pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;数据总行数&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(df))</span><br></pre></td></tr></table></figure><pre><code>数据总行数
249
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;丢失缺失值之后的行数&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(df.dropna()))</span><br></pre></td></tr></table></figure><pre><code>丢失缺失值之后的行数
246
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;包含缺失值的行&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[df[<span class="string">&#x27;交易额&#x27;</span>].isnull()])</span><br></pre></td></tr></table></figure><pre><code>包含缺失值的行
     工号  姓名        日期           时段  交易额    柜台
110  1005  周七  2019-03-14  14：00-21：00     NaN  化妆品
124  1006  钱八  2019-03-16  14：00-21：00     NaN    食品
168  1005  周七  2019-03-21  14：00-21：00     NaN    食品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;使用固定值替换缺失值&#x27;</span>)</span><br><span class="line">dff=deepcopy(df)</span><br><span class="line">dff.loc[dff.交易额.isnull(),<span class="string">&#x27;交易额&#x27;</span>]=<span class="number">1000</span></span><br><span class="line"><span class="built_in">print</span>(dff.iloc[[<span class="number">110</span>,<span class="number">124</span>,<span class="number">168</span>],:])</span><br></pre></td></tr></table></figure><pre><code>使用固定值替换缺失值
     工号  姓名        日期           时段  交易额    柜台
110  1005  周七  2019-03-14  14：00-21：00  1000.0  化妆品
124  1006  钱八  2019-03-16  14：00-21：00  1000.0    食品
168  1005  周七  2019-03-21  14：00-21：00  1000.0    食品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;使用每人交易额均值替换缺失值&#x27;</span>)</span><br><span class="line">dff=deepcopy(df)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dff[dff.交易额.isnull()].index:</span><br><span class="line">    dff.loc[i,<span class="string">&#x27;交易额&#x27;</span>]=<span class="built_in">round</span>(dff.loc[dff.姓名==dff.loc[i,<span class="string">&#x27;姓名&#x27;</span>],<span class="string">&#x27;交易额&#x27;</span>].mean())</span><br><span class="line"><span class="built_in">print</span>(dff.iloc[[<span class="number">110</span>,<span class="number">124</span>,<span class="number">168</span>],:])</span><br></pre></td></tr></table></figure><pre><code>使用每人交易额均值替换缺失值
     工号  姓名        日期           时段  交易额    柜台
110  1005  周七  2019-03-14  14：00-21：00  1195.0  化妆品
124  1006  钱八  2019-03-16  14：00-21：00  1323.0    食品
168  1005  周七  2019-03-21  14：00-21：00  1195.0    食品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;使用整体均值的80%填充&#x27;</span>)</span><br><span class="line">df.fillna(&#123;<span class="string">&#x27;交易额&#x27;</span>:<span class="built_in">round</span>(df[<span class="string">&#x27;交易额&#x27;</span>].mean()*<span class="number">0.8</span>)&#125;,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(df.iloc[[<span class="number">110</span>,<span class="number">124</span>,<span class="number">168</span>],:])</span><br></pre></td></tr></table></figure><pre><code>使用整体均值的80%填充
     工号  姓名        日期           时段  交易额    柜台
110  1005  周七  2019-03-14  14：00-21：00  1064.0  化妆品
124  1006  钱八  2019-03-16  14：00-21：00  1064.0    食品
168  1005  周七  2019-03-21  14：00-21：00  1064.0    食品
</code></pre><h2 id="处理超市交易数据中的重复值">处理超市交易数据中的重复值</h2><p>duplicated(subset=None, keep=‘first’)</p><p>参数subset用来指定判断不同行的数据是否重复时所依据的一列或多列，默认使用整行所有列的数据进行比较；</p><p>参数keep='first’时表示重复数据的第一次出现标记为False，keep='last’时表示重复数据的最后一次出现标记为False，keep=False时表示标记所有重复数据为True。</p><p>drop_duplicates(subset=None, keep=‘first’, inplace=False)</p><p>参数subset和keep的含义与duplicated()方法类似；</p><p>参数inplace=True时表示原地修改，此时duplicated()方法没有返回值，inplace=False时表示返回新的DataFrame结构而不对原来的DataFrame做任何修改。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">df=pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;数据总行数&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(df))</span><br></pre></td></tr></table></figure><pre><code>数据总行数
249
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;数据总行数&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(df))</span><br></pre></td></tr></table></figure><pre><code>数据总行数
249
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;一人同时负责多个柜台的排班&#x27;</span>)</span><br><span class="line">dff=df[[<span class="string">&#x27;工号&#x27;</span>,<span class="string">&#x27;姓名&#x27;</span>,<span class="string">&#x27;日期&#x27;</span>,<span class="string">&#x27;时段&#x27;</span>]]</span><br><span class="line">dff=dff[dff.duplicated()]</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> dff.values:</span><br><span class="line">    <span class="built_in">print</span>(df[ (df.工号==row[<span class="number">0</span>]) &amp; (df.日期==row[<span class="number">2</span>]) &amp; (df.日期==row[<span class="number">2</span>]) &amp;(df.时段==row[<span class="number">3</span>])])</span><br></pre></td></tr></table></figure><pre><code>一人同时负责多个柜台的排班
    工号  姓名        日期           时段  交易额      柜台
49  1002  李四  2019-03-07  14：00-21：00  1199.0    化妆品
55  1002  李四  2019-03-07  14：00-21：00   831.0  蔬菜水果
     工号  姓名        日期           时段  交易额      柜台
103  1006  钱八  2019-03-13  14：00-21：00  1609.0  蔬菜水果
104  1006  钱八  2019-03-13  14：00-21：00  1609.0  蔬菜水果
     工号  姓名        日期          时段  交易额      柜台
171  1006  钱八  2019-03-22  9：00-14：00  1555.0  蔬菜水果
175  1006  钱八  2019-03-22  9：00-14：00  1503.0      食品
     工号  姓名        日期          时段  交易额    柜台
201  1004  赵六  2019-03-26  9：00-14：00  1599.0  化妆品
210  1004  赵六  2019-03-26  9：00-14：00  1257.0  化妆品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#直接丢弃全部行</span></span><br><span class="line">df = df.drop_duplicates()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;有效数据总行&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(df))</span><br></pre></td></tr></table></figure><pre><code>有效数据总行
248
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#可以查看是否有录入错误的工号和姓名</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;所有工号与姓名的对应关系&#x27;</span>)</span><br><span class="line">dff = df[[<span class="string">&#x27;工号&#x27;</span>,<span class="string">&#x27;姓名&#x27;</span>]]</span><br><span class="line"><span class="built_in">print</span>(dff.drop_duplicates())</span><br></pre></td></tr></table></figure><pre><code>所有工号与姓名的对应关系
   工号  姓名
0  1001  张三
1  1002  李四
2  1003  王五
3  1004  赵六
4  1005  周七
5  1006  钱八
</code></pre><h2 id="使用数据差分查看员工业绩波动情况">使用数据差分查看员工业绩波动情况</h2><p>diff(periods=1, axis=0)</p><p>参数periods用来指定差分的跨度，当periods=1且axis=0时表示每一行数据减去紧邻的上一行数据，当periods=2且axis=0时表示每一行减去上面第二行的数据；</p><p>参数axis=0时表示按行进行纵向差分，axis=1时表示按列横向差分。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;每天交易总额变化情况&#x27;</span>)</span><br><span class="line">dff = df.groupby(by=<span class="string">&#x27;日期&#x27;</span>).<span class="built_in">sum</span>()[<span class="string">&#x27;交易额&#x27;</span>].diff()</span><br><span class="line"><span class="built_in">print</span>(dff.<span class="built_in">map</span>(<span class="keyword">lambda</span> num:<span class="string">&#x27;%+.2f&#x27;</span>%num)[:<span class="number">5</span>])</span><br></pre></td></tr></table></figure><pre><code>每天交易总额变化情况
日期
2019-03-01       +nan
2019-03-02    -248.00
2019-03-03    +924.00
2019-03-04     +56.00
2019-03-05    -277.00
Name: 交易额, dtype: object
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;张三的每天交易总额变化情况&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[df.姓名==<span class="string">&#x27;张三&#x27;</span>].groupby(by=<span class="string">&#x27;日期&#x27;</span>).<span class="built_in">sum</span>()[<span class="string">&#x27;交易额&#x27;</span>].diff()[:<span class="number">5</span>])</span><br></pre></td></tr></table></figure><pre><code>张三的每天交易总额变化情况
日期
2019-03-01       NaN
2019-03-02   -1576.0
2019-03-03    -169.0
2019-03-04    -145.0
2019-03-05    1031.0
Name: 交易额, dtype: float64
</code></pre><h2 id="使用透视表与交叉表查看业绩汇总数据">使用透视表与交叉表查看业绩汇总数据</h2><h3 id="透视表">透视表</h3><p>pivot(index=None, columns=None, values=None)</p><p>参数index用来指定使用哪一列数据作为结果DataFrame的索引；</p><p>参数columns用来指定哪一列数据作为结果DataFrame的列名；</p><p>参数values用来指定哪一列数据作为结果DataFrame的值。</p><p>pivot_table(values=None, index=None, columns=None, aggfunc=‘mean’, fill_value=None, margins=False, dropna=True, margins_name=‘All’)</p><p>参数values、index、columns的含义与DataFrame结构的pivot()方法一样；</p><p>参数aggfunc用来指定数据的聚合方式，例如求平均、求和、求中值等；</p><p>参数margins用来指定是否显示边界以及边界上的数据；</p><p>参数margins_name用来指定边界数据的索引名称和列名；</p><p>参数dropna用来指定是否丢弃缺失值。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看每人每天交易总额&#x27;</span>)</span><br><span class="line">dff = df.groupby(by=[<span class="string">&#x27;姓名&#x27;</span>,<span class="string">&#x27;日期&#x27;</span>],as_index=<span class="literal">False</span>).<span class="built_in">sum</span>()</span><br><span class="line"><span class="built_in">print</span>(dff.iloc[:,:<span class="number">5</span>])</span><br></pre></td></tr></table></figure><pre><code>查看每人每天交易总额
     姓名        日期  工号  交易额
0    周七  2019-03-01  1005   994.0
1    周七  2019-03-02  1005  1444.0
2    周七  2019-03-03  2010  3230.0
3    周七  2019-03-04  2010  2545.0
4    周七  2019-03-05  1005  1249.0
..    ...         ...   ...     ...
173  钱八  2019-03-27  2012  2996.0
174  钱八  2019-03-28  1006  1219.0
175  钱八  2019-03-29  1006  1639.0
176  钱八  2019-03-30  1006  1090.0
177  钱八  2019-03-31  1006   812.0

[178 rows x 4 columns]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;交易总额低于5万元的员工前5天业绩&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(dff[dff.<span class="built_in">sum</span>(axis=<span class="number">1</span>)&lt;<span class="number">50000</span>].iloc[:,:<span class="number">5</span>])</span><br></pre></td></tr></table></figure><pre><code>交易总额低于5万元的员工前5天业绩
     姓名        日期  工号  交易额
0    周七  2019-03-01  1005   994.0
1    周七  2019-03-02  1005  1444.0
2    周七  2019-03-03  2010  3230.0
3    周七  2019-03-04  2010  2545.0
4    周七  2019-03-05  1005  1249.0
..    ...         ...   ...     ...
173  钱八  2019-03-27  2012  2996.0
174  钱八  2019-03-28  1006  1219.0
175  钱八  2019-03-29  1006  1639.0
176  钱八  2019-03-30  1006  1090.0
177  钱八  2019-03-31  1006   812.0

[178 rows x 4 columns]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;交易总额低于5万元的员工姓名&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(dff[dff.<span class="built_in">sum</span>(axis=<span class="number">1</span>)&lt;<span class="number">50000</span>].index.values)</span><br></pre></td></tr></table></figure><pre><code>交易总额低于5万元的员工姓名
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;使用pivot_table()方法实现&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.pivot_table(values=<span class="string">&#x27;交易额&#x27;</span>,index=<span class="string">&#x27;姓名&#x27;</span>,columns=<span class="string">&#x27;日期&#x27;</span>,aggfunc=<span class="string">&#x27;sum&#x27;</span>,margins=<span class="literal">True</span>).iloc[:,:<span class="number">5</span>])</span><br></pre></td></tr></table></figure><pre><code>使用pivot_table()方法实现
日期  2019-03-01  2019-03-02  2019-03-03  2019-03-04  2019-03-05
姓名                                                            
周七       994.0      1444.0      3230.0      2545.0      1249.0
张三      3106.0      1530.0      1361.0      1216.0      2247.0
李四       954.0      3044.0      1034.0      2734.0      3148.0
王五      1407.0      2115.0      1713.0      1590.0      1687.0
赵六      1320.0       906.0      2309.0      1673.0       974.0
钱八      2647.0      1141.0      1457.0      1402.0      1578.0
All      10428.0     10180.0     11104.0     11160.0     10883.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看每人在柜台的交易额&#x27;</span>)</span><br><span class="line">dff = df.groupby(by=[<span class="string">&#x27;姓名&#x27;</span>,<span class="string">&#x27;柜台&#x27;</span>],as_index=<span class="literal">False</span>).<span class="built_in">sum</span>()</span><br><span class="line"><span class="built_in">print</span>(df.pivot_table(values=<span class="string">&#x27;交易额&#x27;</span>,index=<span class="string">&#x27;姓名&#x27;</span>,columns=<span class="string">&#x27;日期&#x27;</span>,aggfunc=<span class="string">&#x27;count&#x27;</span>,margins=<span class="literal">True</span>).iloc[:,:<span class="number">5</span>])</span><br></pre></td></tr></table></figure><pre><code>查看每人在柜台的交易额
日期  2019-03-01  2019-03-02  2019-03-03  2019-03-04  2019-03-05
姓名                                                            
周七         1.0         1.0         2.0         2.0         1.0
张三         2.0         1.0         1.0         1.0         2.0
李四         1.0         2.0         1.0         2.0         2.0
王五         1.0         2.0         1.0         1.0         1.0
赵六         1.0         1.0         2.0         1.0         1.0
钱八         2.0         1.0         1.0         1.0         1.0
All          8.0         8.0         8.0         8.0         8.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看每人在各柜台的上班次数&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.pivot_table(values=<span class="string">&#x27;交易额&#x27;</span>,index=<span class="string">&#x27;姓名&#x27;</span>,columns=<span class="string">&#x27;柜台&#x27;</span>,aggfunc=<span class="string">&#x27;count&#x27;</span>,margins=<span class="literal">True</span>))</span><br></pre></td></tr></table></figure><pre><code>查看每人在各柜台的上班次数
柜台  化妆品  日用品  蔬菜水果  食品  All
姓名                                     
周七     8.0    11.0      14.0   7.0   40
张三    19.0     6.0       6.0   7.0   38
李四    16.0     9.0      18.0   4.0   47
王五     8.0     9.0       9.0  14.0   40
赵六    10.0    18.0       2.0  15.0   45
钱八     NaN     9.0      14.0  13.0   36
All     61.0    62.0      63.0  60.0  246
</code></pre><h3 id="交叉表">交叉表</h3><p>交叉表是一种特殊的透视表，往往用来统计频次，也可以使用参数aggfunc指定聚合函数实现其他功能。</p><p>crosstab(index, columns, values=None, rownames=None, colnames=None, aggfunc=None, margins=False, dropna=True, normalize=False)</p><p>参数values、index、columns的含义与DataFrame结构的pivot()方法一样；</p><p>参数aggfunc用来指定聚合函数，默认为统计次数；</p><p>参数rownames和colnames分别用来指定行索引和列索引的名字，如果不指定则直接使用参数index和columns指定的列名。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;每人每天的上班次数&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.crosstab(df.姓名,df.日期,margins=<span class="literal">True</span>).iloc[:,:<span class="number">5</span>])</span><br></pre></td></tr></table></figure><pre><code>每人每天的上班次数
日期  2019-03-01  2019-03-02  2019-03-03  2019-03-04  2019-03-05
姓名                                                            
周七           1           1           2           2           1
张三           2           1           1           1           2
李四           1           2           1           2           2
王五           1           2           1           1           1
赵六           1           1           2           1           1
钱八           2           1           1           1           1
All            8           8           8           8           8
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;每人在各柜台上班总次数&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.crosstab(df.姓名,df.柜台,margins=<span class="literal">True</span>).iloc[:,:<span class="number">5</span>])</span><br></pre></td></tr></table></figure><pre><code>每人在各柜台上班总次数
柜台  化妆品  日用品  蔬菜水果  食品  All
姓名                                     
周七       9      11        14     8   42
张三      19       6         6     7   38
李四      16       9        18     4   47
王五       8       9         9    14   40
赵六      10      18         2    15   45
钱八       0       9        14    14   37
All       62      62        63    62  249
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;每人在各柜台交易总额&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.crosstab(df.姓名,df.柜台,df.交易额,aggfunc=<span class="string">&#x27;sum&#x27;</span>))</span><br></pre></td></tr></table></figure><pre><code>每人在各柜台交易总额
柜台   化妆品   日用品  蔬菜水果     食品
姓名                                     
周七   9516.0  12863.0   16443.0   8996.0
张三  22975.0  18629.0    7265.0   9261.0
李四  20467.0  10104.0   23263.0   4896.0
王五  10112.0  11357.0   10473.0  26950.0
赵六  12319.0  23286.0    2527.0  17937.0
钱八      NaN  11923.0   18561.0  17134.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;每人在各柜台交易额平均值&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.crosstab(df.姓名,df.柜台,df.交易额,aggfunc=<span class="string">&#x27;mean&#x27;</span>).apply(<span class="keyword">lambda</span> num:<span class="built_in">round</span>(num,<span class="number">2</span>)))</span><br></pre></td></tr></table></figure><pre><code>每人在各柜台交易额平均值
柜台   化妆品   日用品  蔬菜水果     食品
姓名                                     
周七  1189.50  1169.36   1174.50  1285.14
张三  1209.21  3104.83   1210.83  1323.00
李四  1279.19  1122.67   1292.39  1224.00
王五  1264.00  1261.89   1163.67  1925.00
赵六  1231.90  1293.67   1263.50  1195.80
钱八      NaN  1324.78   1325.79  1318.00
</code></pre><h2 id="使用重采样技术按时间段查看员工业绩">使用重采样技术按时间段查看员工业绩</h2><p>resample(rule, how=None, axis=0, fill_method=None, closed=None, label=None, convention=‘start’, kind=None, loffset=None, limit=None, base=0, on=None, level=None)</p><p>参数rule用来指定重采样的时间间隔，例如’7D’表示每7天采样一次；</p><p>参数how用来指定如何处理两个采样时间之间的数据，不过该参数很快会被新版本丢弃不用了；</p><p>参数label = 'left’表示使用采样周期的起始时间作为结果DataFrame的index，label='right’表示使用采样周期的结束时间作为结果DataFrame的index；</p><p>参数on用来指定根据哪一列进行重采样，要求该列数据为日期时间类型。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df = pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>)</span><br><span class="line">df.日期 = pd.to_datetime(df.日期)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;每7天营业额&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.resample(<span class="string">&#x27;7D&#x27;</span>,on=<span class="string">&#x27;日期&#x27;</span>,label=<span class="string">&#x27;right&#x27;</span>).<span class="built_in">sum</span>()[<span class="string">&#x27;交易额&#x27;</span>])</span><br></pre></td></tr></table></figure><pre><code>每7天营业额
日期
2019-03-08    73600.0
2019-03-15    77823.0
2019-03-22    65996.0
2019-03-29    79046.0
2019-04-05    30792.0
Freq: 7D, Name: 交易额, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;每7天营业总额&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.resample(<span class="string">&#x27;7D&#x27;</span>,on=<span class="string">&#x27;日期&#x27;</span>).<span class="built_in">sum</span>()[<span class="string">&#x27;交易额&#x27;</span>])</span><br></pre></td></tr></table></figure><pre><code>每7天营业总额
日期
2019-03-01    73600.0
2019-03-08    77823.0
2019-03-15    65996.0
2019-03-22    79046.0
2019-03-29    30792.0
Freq: 7D, Name: 交易额, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;每7天营业额平均值&#x27;</span>)</span><br><span class="line">func = <span class="keyword">lambda</span> num:<span class="built_in">round</span>(num,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(df.resample(<span class="string">&#x27;7D&#x27;</span>,on=<span class="string">&#x27;日期&#x27;</span>,label=<span class="string">&#x27;right&#x27;</span>).mean().apply(func)[<span class="string">&#x27;交易额&#x27;</span>])</span><br></pre></td></tr></table></figure><pre><code>每7天营业额平均值
日期
2019-03-08    1314.29
2019-03-15    1389.70
2019-03-22    1222.15
2019-03-29    1411.54
2019-04-05    1283.00
Freq: 7D, Name: 交易额, dtype: float64
</code></pre><h2 id="多索引相关技术与操作">多索引相关技术与操作</h2><p>DataFrame结构支持多个索引，既可以在读取数据时使用index_col指定多列，也可以通过groupby()方法分组时指定多个索引。对于含有多个索引的DataFrame结构，在使用sort_index()方法按索引排序、使用groupby()方法进行分组时，都可以使用参数level指定按哪一级索引进行排序或分组。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置输出结果对齐方式</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">#删除工号一列的数据 </span></span><br><span class="line">df.drop(<span class="string">&#x27;工号&#x27;</span>,axis=<span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">df = df.groupby(by=[<span class="string">&#x27;姓名&#x27;</span>,<span class="string">&#x27;柜台&#x27;</span>]).<span class="built_in">sum</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;按姓名和柜台进行分组汇总&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[:<span class="number">10</span>])</span><br></pre></td></tr></table></figure><pre><code>按姓名和柜台进行分组汇总
                交易额
姓名 柜台             
周七 化妆品     9516.0
     日用品    12863.0
     蔬菜水果  16443.0
     食品       8996.0
张三 化妆品    22975.0
     日用品    18629.0
     蔬菜水果   7265.0
     食品       9261.0
李四 化妆品    20467.0
     日用品    10104.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看周七的汇总数据&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.loc[<span class="string">&#x27;周七&#x27;</span>,<span class="string">&#x27;化妆品&#x27;</span>])</span><br></pre></td></tr></table></figure><pre><code>查看周七的汇总数据
交易额    9516.0
Name: (周七, 化妆品), dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看周七在化妆品柜台的交易数据&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.loc[(<span class="string">&#x27;周七&#x27;</span>,<span class="string">&#x27;化妆品&#x27;</span>)])</span><br></pre></td></tr></table></figure><pre><code>查看周七在化妆品柜台的交易数据
交易额    9516.0
Name: (周七, 化妆品), dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置输出结果对齐方式</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>)</span><br><span class="line"> <span class="comment">#删除工号一列的数据 </span></span><br><span class="line">df.drop(<span class="string">&#x27;工号&#x27;</span>,axis=<span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#按索引“柜台”排序，查看前12行</span></span><br><span class="line">dff = df.sort_index(level=<span class="string">&#x27;柜台&#x27;</span>,axis=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;按柜台排序，查看前12行&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(dff[:<span class="number">12</span>])</span><br></pre></td></tr></table></figure><pre><code>按柜台排序，查看前12行
    姓名        日期           时段  交易额      柜台
0   张三  2019-03-01   9：00-14：00  1664.0    化妆品
1   李四  2019-03-01  14：00-21：00   954.0    化妆品
2   王五  2019-03-01   9：00-14：00  1407.0      食品
3   赵六  2019-03-01  14：00-21：00  1320.0      食品
4   周七  2019-03-01   9：00-14：00   994.0    日用品
5   钱八  2019-03-01  14：00-21：00  1421.0    日用品
6   钱八  2019-03-01   9：00-14：00  1226.0  蔬菜水果
7   张三  2019-03-01  14：00-21：00  1442.0  蔬菜水果
8   张三  2019-03-02   9：00-14：00  1530.0    化妆品
9   李四  2019-03-02  14：00-21：00  1395.0    化妆品
10  王五  2019-03-02   9：00-14：00   936.0      食品
11  赵六  2019-03-02  14：00-21：00   906.0      食品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#按索引“姓名”排序，查看前12行</span></span><br><span class="line">dff = df.sort_index(level=<span class="string">&#x27;柜台&#x27;</span>,axis=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;按姓名排序，查看前12行&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(dff[:<span class="number">12</span>])</span><br></pre></td></tr></table></figure><pre><code>按姓名排序，查看前12行
    姓名        日期           时段  交易额      柜台
0   张三  2019-03-01   9：00-14：00  1664.0    化妆品
1   李四  2019-03-01  14：00-21：00   954.0    化妆品
2   王五  2019-03-01   9：00-14：00  1407.0      食品
3   赵六  2019-03-01  14：00-21：00  1320.0      食品
4   周七  2019-03-01   9：00-14：00   994.0    日用品
5   钱八  2019-03-01  14：00-21：00  1421.0    日用品
6   钱八  2019-03-01   9：00-14：00  1226.0  蔬菜水果
7   张三  2019-03-01  14：00-21：00  1442.0  蔬菜水果
8   张三  2019-03-02   9：00-14：00  1530.0    化妆品
9   李四  2019-03-02  14：00-21：00  1395.0    化妆品
10  王五  2019-03-02   9：00-14：00   936.0      食品
11  赵六  2019-03-02  14：00-21：00   906.0      食品
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#按索引“柜台”分组求和</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;按柜台分组求和&#x27;</span>)</span><br><span class="line">dfff = dff.groupby(by=<span class="string">&#x27;柜台&#x27;</span>).<span class="built_in">sum</span>() </span><br><span class="line">dfff.columns = [<span class="string">&#x27;交易额总和&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(dfff)</span><br></pre></td></tr></table></figure><pre><code>按柜台分组求和
          交易额总和
柜台                
化妆品       75389.0
日用品       88162.0
蔬菜水果     78532.0
食品         85174.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#按索引“姓名”分组求中值</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;按姓名分组求中值&#x27;</span>)</span><br><span class="line">dfff = dff.groupby(by=<span class="string">&#x27;姓名&#x27;</span>).median() </span><br><span class="line">dfff.columns = [<span class="string">&#x27;交易额中值&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(dfff)</span><br></pre></td></tr></table></figure><pre><code>按姓名分组求中值
      交易额中值
姓名            
周七      1134.5
张三      1290.0
李四      1276.0
王五      1227.0
赵六      1224.0
钱八      1381.0
</code></pre><h2 id="使用标准差与协方差分析员工业绩">使用标准差与协方差分析员工业绩</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置输出结果对齐方式</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#丢弃缺失值和重复值</span></span><br><span class="line">df.dropna(inplace=<span class="literal">True</span>)</span><br><span class="line">df.drop_duplicates(inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#处理缺失值</span></span><br><span class="line">df.loc[df.交易额&lt;<span class="number">200</span>,<span class="string">&#x27;交易额&#x27;</span>] = <span class="number">200</span></span><br><span class="line">df.loc[df.交易额&gt;<span class="number">3000</span>,<span class="string">&#x27;交易额&#x27;</span>] = <span class="number">3000</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用交叉表得到不同员工在不同柜台的交易额平均值</span></span><br><span class="line">dff = pd.crosstab(df.姓名,df.柜台,df.交易额,aggfunc=<span class="string">&#x27;mean&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;标准差&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(dff.std())</span><br></pre></td></tr></table></figure><pre><code>标准差
柜台
化妆品       36.480497
日用品      159.008839
蔬菜水果     60.331171
食品        105.031231
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;协方差&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(dff.cov())</span><br></pre></td></tr></table></figure><pre><code>协方差
柜台           化妆品        日用品     蔬菜水果          食品
柜台                                                          
化妆品    1330.826697  -2296.460562   923.019793    692.300017
日用品   -2296.460562  25283.810853 -1030.111953   2957.850772
蔬菜水果   923.019793  -1030.111953  3639.850206  -3918.549524
食品       692.300017   2957.850772 -3918.549524  11031.559490
</code></pre><h2 id="使用pandas的属性接口实现高级功能">使用pandas的属性接口实现高级功能</h2><p>DataFrame数据中的日期时间列支持dt接口，该接口提供了dayofweek、dayofyear、is_leap_year、quarter、weekday_name等属性和方法，例如quarter可以直接得到每个日期分别是第几个季度，weekday_name可以直接每个日期对应的周几的名字。</p><p>DataFrame数据中的字符串列支持str接口，该接口提供了center、contains、count、endswith、find、extract、lower、split等大量属性和方法。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"><span class="comment">#设置输出结果对齐方式</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>,usecols=[<span class="string">&#x27;日期&#x27;</span>,<span class="string">&#x27;交易额&#x27;</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#深复制，不影响原来的df</span></span><br><span class="line">dff = copy.deepcopy(df)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 把日期列替换为周几</span></span><br><span class="line">dff[<span class="string">&#x27;日期&#x27;</span>] = pd.to_datetime(df[<span class="string">&#x27;日期&#x27;</span>]).dt.weekday</span><br><span class="line"><span class="comment">#按周几分组，查看交易额平均值，四舍五入</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;按周几分组查看交易额平均值&#x27;</span>)</span><br><span class="line">dff = dff.groupby(<span class="string">&#x27;日期&#x27;</span>).mean().apply(<span class="built_in">round</span>)</span><br><span class="line">dff.index.name = <span class="string">&#x27;周几&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(dff)</span><br></pre></td></tr></table></figure><pre><code>按周几分组查看交易额平均值
      交易额
周几        
0     1233.0
1     1258.0
2     1224.0
3     1830.0
4     1277.0
5     1306.0
6     1254.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dff=copy.deepcopy(df) </span><br><span class="line"><span class="comment">#修改日期列，只保留年份和月份 </span></span><br><span class="line">dff[<span class="string">&#x27;日期&#x27;</span>]=dff[<span class="string">&#x27;日期&#x27;</span>].<span class="built_in">str</span>.extract(<span class="string">r&#x27;(\d&#123;4&#125;-\d&#123;2&#125;)&#x27;</span>) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;只查看年份和月份&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(dff[:<span class="number">5</span>])</span><br></pre></td></tr></table></figure><pre><code>只查看年份和月份
      日期  交易额
0  2019-03  1664.0
1  2019-03   954.0
2  2019-03  1407.0
3  2019-03  1320.0
4  2019-03   994.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#按字符串形式的日期最后一位数进行分组 </span></span><br><span class="line"><span class="comment">#该月1、11、21、31日汇总为一组，2、12、22日为一组，以此类推 </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;按日期的日进行分组查看交易额平均值&#x27;</span>) </span><br><span class="line"><span class="built_in">print</span>(df.groupby(df[<span class="string">&#x27;日期&#x27;</span>].<span class="built_in">str</span>.__getitem__(-<span class="number">1</span>)).mean().apply(<span class="built_in">round</span>)) </span><br></pre></td></tr></table></figure><pre><code>按日期的日进行分组查看交易额平均值
      交易额
日期        
0     1178.0
1     1264.0
2     1273.0
3     1317.0
4     1801.0
5     1223.0
6     1292.0
7     1216.0
8     1508.0
9     1266.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看日期尾数为6的数据前12行 </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;査着日期尾数力 6 的数据&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df[df[<span class="string">&#x27;日期&#x27;</span>].<span class="built_in">str</span>.endswith(<span class="string">&#x27;6&#x27;</span>)][:<span class="number">12</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>査着日期尾数力 6 的数据
           日期  交易额
40   2019-03-06  1037.0
41   2019-03-06   822.0
42   2019-03-06  1200.0
43   2019-03-06  1245.0
44   2019-03-06  1699.0
45   2019-03-06  1199.0
46   2019-03-06  1162.0
47   2019-03-06  1778.0
121  2019-03-16  1788.0
122  2019-03-16  1590.0
123  2019-03-16  1498.0
124  2019-03-16     NaN
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看日期尾数为12的数据 #slice（）方法接收3个参数，分别为起始位置、结束位置和步长 </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;日期尾数为12的交易数据&#x27;</span>) </span><br><span class="line"><span class="built_in">print</span>(df[df.日期.<span class="built_in">str</span>.<span class="built_in">slice</span>(-<span class="number">2</span>)==<span class="string">&#x27;12&#x27;</span>])</span><br></pre></td></tr></table></figure><pre><code>日期尾数为12的交易数据
          日期  交易额
88  2019-03-12  1183.0
89  2019-03-12   979.0
90  2019-03-12  1651.0
91  2019-03-12  1435.0
92  2019-03-12  1302.0
93  2019-03-12  1317.0
94  2019-03-12   831.0
95  2019-03-12  1530.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#日期中月份或天数包含2的交易数据第15到第25行 </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;日期中月份或天数包含2的交易数据&#x27;</span>) </span><br><span class="line"><span class="built_in">print</span>(df[df.日期.<span class="built_in">str</span>.<span class="built_in">slice</span>(-<span class="number">5</span>).<span class="built_in">str</span>.contains(<span class="string">&#x27;2&#x27;</span>)][<span class="number">15</span>:<span class="number">25</span>])</span><br></pre></td></tr></table></figure><pre><code>日期中月份或天数包含2的交易数据
           日期  交易额
95   2019-03-12  1530.0
153  2019-03-20  1332.0
154  2019-03-20  1485.0
155  2019-03-20   980.0
156  2019-03-20  1615.0
157  2019-03-20  1037.0
158  2019-03-20  1649.0
159  2019-03-20  1046.0
160  2019-03-20   829.0
161  2019-03-21  1528.0
</code></pre><h2 id="查看dataframe的内存占用情况">查看DataFrame的内存占用情况</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取全部数据，使用默认索引</span></span><br><span class="line">df = pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;交易额列占用内存情况&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;交易额&#x27;</span>].memory_usage())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;内存占用情况&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(df.memory_usage())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;内存占用总额&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(df.memory_usage().<span class="built_in">sum</span>())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;使用df.info()查看内存占用&#x27;</span>.ljust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>))</span><br><span class="line">df.info()</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>交易额列占用内存情况==========
2120
内存占用情况==============
Index      128
工号      1992
姓名      1992
日期      1992
时段      1992
交易额    1992
柜台      1992
dtype: int64
内存占用总额==============
12080
使用df.info()查看内存占用===
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 249 entries, 0 to 248
Data columns (total 6 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   工号      249 non-null    int64  
 1   姓名      249 non-null    object 
 2   日期      249 non-null    object 
 3   时段      249 non-null    object 
 4   交易额     246 non-null    float64
 5   柜台      249 non-null    object 
dtypes: float64(1), int64(1), object(4)
memory usage: 11.8+ KB
</code></pre><h2 id="数据拆分与合并">数据拆分与合并</h2><h3 id="concat-函数与append-方法">concat()函数与append()方法</h3><p>根据不同的需要，可以对DataFrame使用切片或loc等运算按行或列进行拆分，得到多个DataFrame结构。扩展库pandas提供了concat()函数用于合并多个DataFrame结构，完整语法如下：</p><p>concat(objs, axis=0, join=‘outer’, join_axes=None, ignore_index=False, keys=None, levels=None, names=None, verify_integrity=False, copy=True)</p><p>参数objs表示包含多个Series、DataFrame或Panel对象的序列；</p><p>参数axis默认为0，表示按行进行纵向合并和扩展。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"><span class="comment">#设置输出结果对齐方式</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>)</span><br><span class="line">df5 = pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>,sheet_name=<span class="string">&#x27;Sheet2&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#按行拆分</span></span><br><span class="line">df1 = df[:<span class="number">3</span>]</span><br><span class="line">df2 = df[<span class="number">50</span>:<span class="number">53</span>]</span><br><span class="line"><span class="comment">#按行进行合并，要求多个dataFarame结构相同</span></span><br><span class="line">df3 = pd.concat([df1,df2,df5])</span><br><span class="line"><span class="comment">#使用append()方法按行合并，忽略原来的索引</span></span><br><span class="line">df4 = df1.append([df2,df5],ignore_index=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#按列进行拆分</span></span><br><span class="line">df6 = df.loc[:,[<span class="string">&#x27;姓名&#x27;</span>,<span class="string">&#x27;柜台&#x27;</span>,<span class="string">&#x27;交易额&#x27;</span>]]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df1,df2,df3,df4,df[:<span class="number">5</span>],sep=<span class="string">&#x27;\n\n&#x27;</span>)</span><br></pre></td></tr></table></figure><pre><code>   工号  姓名        日期           时段  交易额    柜台
0  1001  张三  2019-03-01   9：00-14：00  1664.0  化妆品
1  1002  李四  2019-03-01  14：00-21：00   954.0  化妆品
2  1003  王五  2019-03-01   9：00-14：00  1407.0    食品

    工号  姓名        日期           时段  交易额    柜台
50  1004  赵六  2019-03-07   9：00-14：00  1340.0    食品
51  1004  赵六  2019-03-07  14：00-21：00   942.0    食品
52  1005  周七  2019-03-07   9：00-14：00  1465.0  日用品

    工号  姓名        日期           时段  交易额      柜台
0   1001  张三  2019-03-01   9：00-14：00  1664.0    化妆品
1   1002  李四  2019-03-01  14：00-21：00   954.0    化妆品
2   1003  王五  2019-03-01   9：00-14：00  1407.0      食品
50  1004  赵六  2019-03-07   9：00-14：00  1340.0      食品
51  1004  赵六  2019-03-07  14：00-21：00   942.0      食品
52  1005  周七  2019-03-07   9：00-14：00  1465.0    日用品
0   1001  张三  2019-04-01   9：00-14：00  1367.0    化妆品
1   1002  李四  2019-04-01  14：00-21：00  1005.0    化妆品
2   1003  王五  2019-04-01   9：00-14：00  1460.0      食品
3   1004  赵六  2019-04-01  14：00-21：00  1270.0      食品
4   1005  周七  2019-04-01   9：00-14：00  1123.0    日用品
5   1006  钱八  2019-04-01  14：00-21：00  1321.0    日用品
6   1007  孙九  2019-04-01   9：00-14：00  1364.0  蔬菜水果
7   1007  孙九  2019-04-01  14：00-21：00  1633.0  蔬菜水果

    工号  姓名        日期           时段  交易额      柜台
0   1001  张三  2019-03-01   9：00-14：00  1664.0    化妆品
1   1002  李四  2019-03-01  14：00-21：00   954.0    化妆品
2   1003  王五  2019-03-01   9：00-14：00  1407.0      食品
3   1004  赵六  2019-03-07   9：00-14：00  1340.0      食品
4   1004  赵六  2019-03-07  14：00-21：00   942.0      食品
5   1005  周七  2019-03-07   9：00-14：00  1465.0    日用品
6   1001  张三  2019-04-01   9：00-14：00  1367.0    化妆品
7   1002  李四  2019-04-01  14：00-21：00  1005.0    化妆品
8   1003  王五  2019-04-01   9：00-14：00  1460.0      食品
9   1004  赵六  2019-04-01  14：00-21：00  1270.0      食品
10  1005  周七  2019-04-01   9：00-14：00  1123.0    日用品
11  1006  钱八  2019-04-01  14：00-21：00  1321.0    日用品
12  1007  孙九  2019-04-01   9：00-14：00  1364.0  蔬菜水果
13  1007  孙九  2019-04-01  14：00-21：00  1633.0  蔬菜水果

   工号  姓名        日期           时段  交易额    柜台
0  1001  张三  2019-03-01   9：00-14：00  1664.0  化妆品
1  1002  李四  2019-03-01  14：00-21：00   954.0  化妆品
2  1003  王五  2019-03-01   9：00-14：00  1407.0    食品
3  1004  赵六  2019-03-01  14：00-21：00  1320.0    食品
4  1005  周七  2019-03-01   9：00-14：00   994.0  日用品
</code></pre><h3 id="merge-方法">merge()方法</h3><p>merge(right, how=‘inner’, on=None, left_on=None, right_on=None, left_index=False, right_index=False, sort=False, suffixes=(’_x’, ‘_y’), copy=True, indicator=False)</p><p>参数right表示另一个DataFrame结构；</p><p>参数how的取值可以是’left’、‘right’、'outer’或’inner’之一，表示数据连接的方式；</p><p>参数on用来指定连接时依据的列名或包含若干列名的列表，要求指定的列名在两个DataFrame中都存在，如果没有任何参数指定连接键则根据两个DataFrame的列名交集进行连接；</p><p>参数left_on和right_on分别用来指定连接时依据的左侧列名标签和右侧列名标签。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"><span class="comment">#设置输出结果对齐方式</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df1 = pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>)</span><br><span class="line">df2 = pd.read_excel(<span class="string">r&#x27;超市营业额2.xlsx&#x27;</span>,sheet_name=<span class="string">&#x27;Sheet3&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#按同名的列合并，随机查看10行数据 </span></span><br><span class="line">rows=np.random.randint(<span class="number">0</span>,<span class="built_in">len</span>(df1),<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.merge(df1,df2).iloc[rows,:],end=<span class="string">&#x27;\n\n&#x27;</span>) </span><br><span class="line"><span class="comment">#按工号合并，指定其他同名列的后级 </span></span><br><span class="line"><span class="built_in">print</span>(pd.merge(df1,df2,on=<span class="string">&#x27;工号&#x27;</span>, suffixes=[<span class="string">&#x27;_x&#x27;</span>,<span class="string">&#x27;_y&#x27;</span>]).iloc[rows,:],end=<span class="string">&#x27;\n\n&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>     工号  姓名        日期           时段  交易额      柜台  职级
83   1002  李四  2019-03-31   9：00-14：00  1274.0    化妆品  主管
217  1006  钱八  2019-03-05  14：00-21：00  1578.0    日用品  员工
156  1004  赵六  2019-03-22  14：00-21：00   981.0    日用品  员工
171  1005  周七  2019-03-02   9：00-14：00  1444.0    日用品  员工
178  1005  周七  2019-03-06  14：00-21：00  1778.0  蔬菜水果  员工
187  1005  周七  2019-03-12  14：00-21：00  1317.0    化妆品  员工
199  1005  周七  2019-03-20   9：00-14：00  1046.0      食品  员工
52   1002  李四  2019-03-10   9：00-14：00  1478.0  蔬菜水果  主管
55   1002  李四  2019-03-13  14：00-21：00    98.0    日用品  主管
108  1003  王五  2019-03-19  14：00-21：00  1026.0    化妆品  组长

     工号 姓名_x        日期           时段  交易额      柜台 姓名_y  职级
83   1002   李四  2019-03-31   9：00-14：00  1274.0    化妆品   李四  主管
217  1006   钱八  2019-03-05  14：00-21：00  1578.0    日用品   钱八  员工
156  1004   赵六  2019-03-22  14：00-21：00   981.0    日用品   赵六  员工
171  1005   周七  2019-03-02   9：00-14：00  1444.0    日用品   周七  员工
178  1005   周七  2019-03-06  14：00-21：00  1778.0  蔬菜水果   周七  员工
187  1005   周七  2019-03-12  14：00-21：00  1317.0    化妆品   周七  员工
199  1005   周七  2019-03-20   9：00-14：00  1046.0      食品   周七  员工
52   1002   李四  2019-03-10   9：00-14：00  1478.0  蔬菜水果   李四  主管
55   1002   李四  2019-03-13  14：00-21：00    98.0    日用品   李四  主管
108  1003   王五  2019-03-19  14：00-21：00  1026.0    化妆品   王五  组长
</code></pre><p>​</p><h3 id="join-方法">join()方法</h3><p>DataFrame结构的join()方法也可以实现按列对左表（调用join()方法的DataFrame）和右表合并，如果右表other索引与左表某列的值相同可以直接连接，如果要根据右表other中某列的值与左表进行连接，需要先对右表other调用set_index()方法设定该列作为索引。</p><p>join(other, on=None, how=‘left’, lsuffix=’’, rsuffix=’’, sort=False)</p><p>参数other表示另一个DataFrame结构，也就是右表；</p><p>参数on用来指定连接时依据的左表列名，如果不指定则按左表索引index的值进行连接；</p><p>参数how的含义与merge()方法的how相同；</p><p>参数lsuffix和rsuffix用来指定列名的后缀。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#两个表都设置工号列为索引 </span></span><br><span class="line"><span class="built_in">print</span>(df1.set_index(<span class="string">&#x27;工号&#x27;</span>).join(df2.set_index(<span class="string">&#x27;工号&#x27;</span>), lsuffix=<span class="string">&#x27;_x&#x27;</span> ,rsuffix=<span class="string">&#x27;_y&#x27;</span>).iloc[rows,:])</span><br></pre></td></tr></table></figure><pre><code>     姓名_x        日期           时段  交易额      柜台 姓名_y  职级
工号                                                                 
1002   李四  2019-03-31   9：00-14：00  1274.0    化妆品   李四  主管
1006   钱八  2019-03-05  14：00-21：00  1578.0    日用品   钱八  员工
1004   赵六  2019-03-22  14：00-21：00   981.0    日用品   赵六  员工
1005   周七  2019-03-02   9：00-14：00  1444.0    日用品   周七  员工
1005   周七  2019-03-06  14：00-21：00  1778.0  蔬菜水果   周七  员工
1005   周七  2019-03-12  14：00-21：00  1317.0    化妆品   周七  员工
1005   周七  2019-03-20   9：00-14：00  1046.0      食品   周七  员工
1002   李四  2019-03-10   9：00-14：00  1478.0  蔬菜水果   李四  主管
1002   李四  2019-03-13  14：00-21：00    98.0    日用品   李四  主管
1003   王五  2019-03-19  14：00-21：00  1026.0    化妆品   王五  组长
</code></pre><blockquote><p>来自书籍：《Python数据分析、挖掘与可视化》</p></blockquote></article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/t.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/t.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">Rshimmer</div><div class="post-copyright__author_desc">小平凡的记录</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://rshimmering.github.io/posts/d966146.html">原创</a><a class="post-copyright-title"><span onclick='rm.copyPageUrl("https://rshimmering.github.io/posts/d966146.html")'>Python——第7章 pandas数据分析实战</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://rshimmering.github.io/posts/d966146.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=Python——第7章 pandas数据分析实战&amp;url=https://rshimmering.github.io/posts/d966146.html&amp;pic=/pageimg/2027105.jpg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="rm.copyPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://Rshimmering.github.io" target="_blank">Rshimmer</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Python/"><span class="tags-punctuation"><i class="anzhiyufont anzhiyu-icon-tag"></i></span>Python<span class="tagsPageCount">7</span></a><a class="post-meta__box__tags" href="/tags/pandas/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>pandas<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="/pageimg/wallhaven-rd83kq.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/379ecd07.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pageimg/248307.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Python——第6章 Numpy库的使用</div></div></a></div><div class="next-post pull-right"><a href="/posts/ac5cb4aa.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pageimg/wallhaven-xlkegz.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">机器学习概述</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size:1.5rem;margin-right:4px"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/c455d330.html" title="Python——第3章 列表、元组、字典、集合与字符串"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pageimg/1198802.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-06-07</div><div class="title">Python——第3章 列表、元组、字典、集合与字符串</div></div></a></div><div><a href="/posts/e818e21.html" title="Python——第2章 数据类型、运算符与内置函数"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pageimg/666870.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-06-07</div><div class="title">Python——第2章 数据类型、运算符与内置函数</div></div></a></div><div><a href="/posts/379ecd07.html" title="Python——第6章 Numpy库的使用"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pageimg/248307.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-06-07</div><div class="title">Python——第6章 Numpy库的使用</div></div></a></div><div><a href="/posts/2b6b9f44.html" title="Python日常记录笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pageimg/1108099.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-06-20</div><div class="title">Python日常记录笔记</div></div></a></div><div><a href="/posts/fd7a19d1.html" title="Python数据挖掘——基于数据挖掘的上市公司财务造假识别（制造业）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pageimg/wallhaven-m917o9.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-06-07</div><div class="title">Python数据挖掘——基于数据挖掘的上市公司财务造假识别（制造业）</div></div></a></div><div><a href="/posts/befeb9c9.html" title="Python数据分析——教育平台的线上课程智能推荐策略（2020泰迪杯数据分析技能赛）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pageimg/wallhaven-0w2y76.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-06-06</div><div class="title">Python数据分析——教育平台的线上课程智能推荐策略（2020泰迪杯数据分析技能赛）</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-top" title="点击展开"><div class="card-info-avatar"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/t.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-status-box"><div class="author-status"><g-emoji class="g-emoji" alias="writing_hand" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/270d.png">✍️</g-emoji><span>on Studying</span></div></div></div></div><div class="author-info__description">人生万事须自为</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">Rshimmer</h1><div class="author-info__desc">小平凡的记录</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/Rshimmering" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#pandas%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.</span> <span class="toc-text">pandas常用数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84%E4%B8%8E%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C"><span class="toc-number">1.1.</span> <span class="toc-text">一维数组与常用操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E4%B8%8E%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C"><span class="toc-number">1.2.</span> <span class="toc-text">时间序列与常用操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84dataframe"><span class="toc-number">1.3.</span> <span class="toc-text">二维数组DataFrame</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#dataframe%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B8%8E%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98"><span class="toc-number">2.</span> <span class="toc-text">DataFrame数据处理与分析实战</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96excel%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">2.1.</span> <span class="toc-text">读取Excel文件中的数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%9B%E9%80%89%E7%AC%A6%E5%90%88%E7%89%B9%E5%AE%9A%E6%9D%A1%E4%BB%B6%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">2.2.</span> <span class="toc-text">筛选符合特定条件的数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E6%A0%87%E7%AD%BEat"><span class="toc-number">2.2.1.</span> <span class="toc-text">基于标签at</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E4%BD%8D%E7%BD%AEiat"><span class="toc-number">2.2.2.</span> <span class="toc-text">基于位置iat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%88%97%E7%9A%84%E9%80%89%E5%8F%96"><span class="toc-number">2.2.3.</span> <span class="toc-text">单列的选取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E5%88%97%E7%9A%84%E9%80%89%E5%8F%96"><span class="toc-number">2.2.4.</span> <span class="toc-text">多列的选取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E7%9A%84%E9%80%89%E5%8F%96"><span class="toc-number">2.2.5.</span> <span class="toc-text">单行的选取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%A1%8C%E7%9A%84%E9%80%89%E5%8F%96"><span class="toc-number">2.2.6.</span> <span class="toc-text">多行的选取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9D%97%E7%9A%84%E9%80%89%E5%8F%96"><span class="toc-number">2.2.7.</span> <span class="toc-text">块的选取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE%E6%9D%A1%E4%BB%B6%E8%BF%87%E6%BB%A4%E8%A1%8C-%E5%B8%83%E5%B0%94%E7%B4%A2%E5%BC%95"><span class="toc-number">2.2.8.</span> <span class="toc-text">根据条件过滤行（布尔索引）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E7%B4%A2%E5%BC%95-%E5%A4%9A%E5%B1%82%E7%B4%A2%E5%BC%95"><span class="toc-number">2.2.9.</span> <span class="toc-text">高级索引（多层索引）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E7%B4%A2%E5%BC%95-%E8%B0%83%E4%BD%8Dlevel"><span class="toc-number">2.2.10.</span> <span class="toc-text">高级索引（调位level）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E7%B4%A2%E5%BC%95-%E9%87%8D%E8%AE%BEindex"><span class="toc-number">2.2.11.</span> <span class="toc-text">高级索引（重设index）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E7%89%B9%E5%BE%81%E5%92%8C%E7%BB%9F%E8%AE%A1%E4%BF%A1%E6%81%AF"><span class="toc-number">2.3.</span> <span class="toc-text">查看数据特征和统计信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E7%89%B9%E5%BE%81"><span class="toc-number">2.3.1.</span> <span class="toc-text">查看数据特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1%E7%89%B9%E5%BE%81"><span class="toc-number">2.3.2.</span> <span class="toc-text">统计特征</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%89%E4%B8%8D%E5%90%8C%E6%A0%87%E5%87%86%E5%AF%B9%E6%95%B0%E6%8D%AE%E6%8E%92%E5%BA%8F"><span class="toc-number">2.4.</span> <span class="toc-text">按不同标准对数据排序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sort-values"><span class="toc-number">2.4.1.</span> <span class="toc-text">sort_values()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sort-index"><span class="toc-number">2.4.2.</span> <span class="toc-text">sort.index()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%88%86%E7%BB%84%E4%B8%8E%E8%81%9A%E5%90%88%E5%AF%B9%E5%91%98%E5%B7%A5%E4%B8%9A%E7%BB%A9%E8%BF%9B%E8%A1%8C%E6%B1%87%E6%80%BB"><span class="toc-number">2.5.</span> <span class="toc-text">使用分组与聚合对员工业绩进行汇总</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E5%BC%82%E5%B8%B8%E5%80%BC%E5%A4%84%E7%90%86"><span class="toc-number">2.6.</span> <span class="toc-text">数据的异常值处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E8%B6%85%E5%B8%82%E4%BA%A4%E6%98%93%E9%A2%9D%E6%95%B0%E6%8D%AE%E4%B8%AD%E7%9A%84%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="toc-number">2.7.</span> <span class="toc-text">处理超市交易额数据中的缺失值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E8%B6%85%E5%B8%82%E4%BA%A4%E6%98%93%E6%95%B0%E6%8D%AE%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E5%80%BC"><span class="toc-number">2.8.</span> <span class="toc-text">处理超市交易数据中的重复值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E5%B7%AE%E5%88%86%E6%9F%A5%E7%9C%8B%E5%91%98%E5%B7%A5%E4%B8%9A%E7%BB%A9%E6%B3%A2%E5%8A%A8%E6%83%85%E5%86%B5"><span class="toc-number">2.9.</span> <span class="toc-text">使用数据差分查看员工业绩波动情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E9%80%8F%E8%A7%86%E8%A1%A8%E4%B8%8E%E4%BA%A4%E5%8F%89%E8%A1%A8%E6%9F%A5%E7%9C%8B%E4%B8%9A%E7%BB%A9%E6%B1%87%E6%80%BB%E6%95%B0%E6%8D%AE"><span class="toc-number">2.10.</span> <span class="toc-text">使用透视表与交叉表查看业绩汇总数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%8F%E8%A7%86%E8%A1%A8"><span class="toc-number">2.10.1.</span> <span class="toc-text">透视表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%A4%E5%8F%89%E8%A1%A8"><span class="toc-number">2.10.2.</span> <span class="toc-text">交叉表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E9%87%8D%E9%87%87%E6%A0%B7%E6%8A%80%E6%9C%AF%E6%8C%89%E6%97%B6%E9%97%B4%E6%AE%B5%E6%9F%A5%E7%9C%8B%E5%91%98%E5%B7%A5%E4%B8%9A%E7%BB%A9"><span class="toc-number">2.11.</span> <span class="toc-text">使用重采样技术按时间段查看员工业绩</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%B4%A2%E5%BC%95%E7%9B%B8%E5%85%B3%E6%8A%80%E6%9C%AF%E4%B8%8E%E6%93%8D%E4%BD%9C"><span class="toc-number">2.12.</span> <span class="toc-text">多索引相关技术与操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%A0%87%E5%87%86%E5%B7%AE%E4%B8%8E%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90%E5%91%98%E5%B7%A5%E4%B8%9A%E7%BB%A9"><span class="toc-number">2.13.</span> <span class="toc-text">使用标准差与协方差分析员工业绩</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8pandas%E7%9A%84%E5%B1%9E%E6%80%A7%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0%E9%AB%98%E7%BA%A7%E5%8A%9F%E8%83%BD"><span class="toc-number">2.14.</span> <span class="toc-text">使用pandas的属性接口实现高级功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8Bdataframe%E7%9A%84%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8%E6%83%85%E5%86%B5"><span class="toc-number">2.15.</span> <span class="toc-text">查看DataFrame的内存占用情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%8B%86%E5%88%86%E4%B8%8E%E5%90%88%E5%B9%B6"><span class="toc-number">2.16.</span> <span class="toc-text">数据拆分与合并</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#concat-%E5%87%BD%E6%95%B0%E4%B8%8Eappend-%E6%96%B9%E6%B3%95"><span class="toc-number">2.16.1.</span> <span class="toc-text">concat()函数与append()方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#merge-%E6%96%B9%E6%B3%95"><span class="toc-number">2.16.2.</span> <span class="toc-text">merge()方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#join-%E6%96%B9%E6%B3%95"><span class="toc-number">2.16.3.</span> <span class="toc-text">join()方法</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/edad30be.html" title="安知鱼主题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pageimg/wallhaven-rd83kq.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="安知鱼主题"></a><div class="content"><a class="title" href="/posts/edad30be.html" title="安知鱼主题">安知鱼主题</a><time datetime="2023-08-12T08:00:00.000Z" title="发表于 2023-08-12 16:00:00">2023-08-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/b27157e3.html" title="butterfly魔改之侧边栏"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pageimg/220938.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="butterfly魔改之侧边栏"></a><div class="content"><a class="title" href="/posts/b27157e3.html" title="butterfly魔改之侧边栏">butterfly魔改之侧边栏</a><time datetime="2023-07-19T08:30:10.000Z" title="发表于 2023-07-19 16:30:10">2023-07-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a1ca92f1.html" title="butterfly魔改之文章"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pageimg/61647_20735781941.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="butterfly魔改之文章"></a><div class="content"><a class="title" href="/posts/a1ca92f1.html" title="butterfly魔改之文章">butterfly魔改之文章</a><time datetime="2023-07-19T08:29:23.000Z" title="发表于 2023-07-19 16:29:23">2023-07-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/1c0f0f76.html" title="butterfly魔改之导航栏"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pageimg/131947_58797511237.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="butterfly魔改之导航栏"></a><div class="content"><a class="title" href="/posts/1c0f0f76.html" title="butterfly魔改之导航栏">butterfly魔改之导航栏</a><time datetime="2023-07-19T08:28:59.000Z" title="发表于 2023-07-19 16:28:59">2023-07-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/7b5a6497.html" title="PDF文件"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pageimg/1139541.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="PDF文件"></a><div class="content"><a class="title" href="/posts/7b5a6497.html" title="PDF文件">PDF文件</a><time datetime="2023-07-18T03:00:00.000Z" title="发表于 2023-07-18 11:00:00">2023-07-18</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" target="_blank" rel="noopener" href="https://weibo.com" title="微博"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/Rshimmering" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><img class="footer_mini_logo" title="返回顶部" onclick="anzhiyu.scrollToDest(0,500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/t.jpg" size="50px"><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://v.douyin.com/DwCpMEy/" title="抖音"><i class="anzhiyufont anzhiyu-icon-tiktok"></i></a></div><div class="copyright">&copy;2023 By Rshimmer</div><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/work.png" alt="摸鱼~" title="摸鱼~"><div id="runtimeTextTip"></div></div><div class="footer_custom_text">生活的理想就是为了理想的生活</div></div></footer></div></div></div><div id="sidebar"><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/t.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">42</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">10</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span>文章</span></a><ul class="menus_item_child" style="left:-79px"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size:.9em"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size:.9em"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size:.9em"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child" style="left:-31px"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size:.9em"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size:.9em"></i><span> 百宝箱</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span>关于</span></a><ul class="menus_item_child" style="left:-79px"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size:.9em"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size:.9em"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size:.9em"></i><span> 随便逛逛</span></a></li></ul></div></div></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size:1rem"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display:none"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.14/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.3.1/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@5.0.14/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("06/01/2023 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2023 By 安知鱼 V1.5.3",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Rshimmer 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async>(function () {
  var grt = new Date("06/01/2023 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      img.src = "/img/bei.png";
      img.title = "下班了就该开开心心的玩耍，嘿嘿~";
      img.alt = "下班了就该开开心心的玩耍，嘿嘿~";

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail="visitor@anheyu.com"</script><script>//动态标题
let leaveTitle = 'w(ﾟДﾟ)w 不要走！再看看嘛！';
let backTitle = '♪(^∇^*)欢迎肥来！';
let OriginTitile = document.title
let titleTime
document.addEventListener('visibilitychange', function () {
  if (document.hidden) {
    //离开当前页面时标签显示内容
    document.title = leaveTitle
    clearTimeout(titleTime)
  } else {
    //返回当前页面时标签显示内容
    document.title = backTitle + OriginTitile
    //两秒后变回正常标题
    titleTime = setTimeout(function () {
      document.title = OriginTitile
    }, 2000)
  }
})</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script>// 初始化函数
let rm = {};

//禁止图片与超链接拖拽
let aElements = document.getElementsByTagName("a");
for (let i = 0; i < aElements.length; i++) {
  aElements[i].setAttribute("draggable", "false");
  let imgElements = aElements[i].getElementsByTagName("img");
  for (let j = 0; j < imgElements.length; j++) {
    imgElements[j].setAttribute("draggable", "false");
  }
}

// 显示菜单
rm.showRightMenu = function (isTrue, x = 0, y = 0) {
  console.info(x, y)
  let rightMenu = document.getElementById("rightMenu");
  rightMenu.style.top = x + "px";
  rightMenu.style.left = y + "px";
  if (isTrue) {
    rightMenu.style.display = "block";
    stopMaskScroll();
  } else {
    rightMenu.style.display = "none";
  }
};

// 隐藏菜单
rm.hideRightMenu = function () {
  rm.showRightMenu(false);
  let rightMenuMask = document.querySelector("#rightmenu-mask");
  rightMenuMask.style.display = "none";
};

// 尺寸
let rmWidth = document.getElementById("rightMenu").offsetWidth;
let rmHeight = document.getElementById("rightMenu").offsetHeight;

// 重新定义尺寸
rm.reloadrmSize = function () {
  rightMenu.style.visibility = "hidden";
  rightMenu.style.display = "block";
  // 获取宽度和高度
  rmWidth = document.getElementById("rightMenu").offsetWidth;
  rmHeight = document.getElementById("rightMenu").offsetHeight;
  rightMenu.style.visibility = "visible";
};

// 获取点击的href
let domhref = "";
let domImgSrc = "";
let globalEvent = null;

var oncontextmenuFunction = function (event) {
  if (document.body.clientWidth > 768) {
    let pageX = event.clientX + 10; //加10是为了防止显示时鼠标遮在菜单上
    let pageY = event.clientY;

    //其他额外菜单
    const $rightMenuOther = document.querySelector(".rightMenuOther");
    const $rightMenuPlugin = document.querySelector(".rightMenuPlugin");
    const $rightMenuCopyText = document.querySelector("#menu-copytext");
    const $rightMenuPasteText = document.querySelector("#menu-pastetext");
    const $rightMenuCommentText = document.querySelector("#menu-commenttext");
    const $rightMenuNewWindow = document.querySelector("#menu-newwindow");
    const $rightMenuNewWindowImg = document.querySelector("#menu-newwindowimg");
    const $rightMenuCopyLink = document.querySelector("#menu-copylink");
    const $rightMenuCopyImg = document.querySelector("#menu-copyimg");
    const $rightMenuDownloadImg = document.querySelector("#menu-downloadimg");
    const $rightMenuSearch = document.querySelector("#menu-search");
    const $rightMenuSearchBaidu = document.querySelector("#menu-searchBaidu");
    const $rightMenuMusicToggle = document.querySelector("#menu-music-toggle");
    const $rightMenuMusicBack = document.querySelector("#menu-music-back");
    const $rightMenuMusicForward = document.querySelector("#menu-music-forward");
    const $rightMenuMusicPlaylist = document.querySelector("#menu-music-playlist");
    const $rightMenuMusicCopyMusicName = document.querySelector("#menu-music-copyMusicName");

    let href = event.target.href;
    let imgsrc = event.target.currentSrc;

    // 判断模式 扩展模式为有事件
    let pluginMode = false;
    $rightMenuOther.style.display = "block";
    globalEvent = event;

    // 检查是否需要复制 是否有选中文本
    if (selectTextNow && window.getSelection()) {
      pluginMode = true;
      $rightMenuCopyText.style.display = "block";
      $rightMenuCommentText.style.display = "block";
      $rightMenuSearch.style.display = "block";
      $rightMenuSearchBaidu.style.display = "block";
    } else {
      $rightMenuCopyText.style.display = "none";
      $rightMenuCommentText.style.display = "none";
      $rightMenuSearchBaidu.style.display = "none";
      $rightMenuSearch.style.display = "none";
    }

    //检查是否右键点击了链接a标签
    if (href) {
      pluginMode = true;
      $rightMenuNewWindow.style.display = "block";
      $rightMenuCopyLink.style.display = "block";
      domhref = href;
    } else {
      $rightMenuNewWindow.style.display = "none";
      $rightMenuCopyLink.style.display = "none";
    }

    //检查是否需要复制图片
    if (imgsrc) {
      pluginMode = true;
      $rightMenuCopyImg.style.display = "block";
      $rightMenuDownloadImg.style.display = "block";
      $rightMenuNewWindowImg.style.display = "block";
      document.getElementById("rightMenu").style.width="12rem"
      domImgSrc = imgsrc;
    } else {
      $rightMenuCopyImg.style.display = "none";
      $rightMenuDownloadImg.style.display = "none";
      $rightMenuNewWindowImg.style.display = "none";
    }

    // 判断是否为输入框
    if (event.target.tagName.toLowerCase() === "input" || event.target.tagName.toLowerCase() === "textarea") {
      pluginMode = true;
      $rightMenuPasteText.style.display = "block";
    } else {
      $rightMenuPasteText.style.display = "none";
    }
    const navMusicEl = document.querySelector("#nav-music");
    //判断是否是音乐
    if (navMusicEl && navMusicEl.contains(event.target)) {
      pluginMode = true;
      $rightMenuMusicToggle.style.display = "block";
      $rightMenuMusicBack.style.display = "block";
      $rightMenuMusicForward.style.display = "block";
      $rightMenuMusicPlaylist.style.display = "block";
      $rightMenuMusicCopyMusicName.style.display = "block";
    } else {
      $rightMenuMusicToggle.style.display = "none";
      $rightMenuMusicBack.style.display = "none";
      $rightMenuMusicForward.style.display = "none";
      $rightMenuMusicPlaylist.style.display = "none";
      $rightMenuMusicCopyMusicName.style.display = "none";
    }

    // 如果不是扩展模式则隐藏扩展模块
    if (pluginMode) {
      $rightMenuOther.style.display = "none";
      $rightMenuPlugin.style.display = "block";
    } else {
      $rightMenuPlugin.style.display = "none";
    }

    rm.reloadrmSize();

    // 鼠标默认显示在鼠标右下方，当鼠标靠右或靠下时，将菜单显示在鼠标左方\上方
    if (pageX + rmWidth > window.innerWidth) {
      pageX -= rmWidth + 10;
    }
    if (pageY + rmHeight > window.innerHeight) {
      pageY -= pageY + rmHeight - window.innerHeight;
    }

    rm.showRightMenu(true, pageY, pageX);
    document.getElementById("rightmenu-mask").style.display = "flex";
    return false;
  }
};

// 监听右键初始化
window.oncontextmenu = oncontextmenuFunction

// 下载图片状态
rm.downloadimging = false;

// 复制图片到剪贴板
rm.writeClipImg = function (imgsrc) {
  console.log("按下复制");
  rm.hideRightMenu();
  anzhiyu.snackbarShow("正在下载中，请稍后", false, 10000);
  if (rm.downloadimging == false) {
    rm.downloadimging = true;
    setTimeout(function () {
      copyImage(imgsrc);
      anzhiyu.snackbarShow("复制成功！图片已添加盲水印，请遵守版权协议");
      rm.downloadimging = false;
    }, "10000");
  }
};

function imageToBlob(imageURL) {
  const img = new Image();
  const c = document.createElement("canvas");
  const ctx = c.getContext("2d");
  img.crossOrigin = "";
  img.src = imageURL;
  return new Promise(resolve => {
    img.onload = function () {
      c.width = this.naturalWidth;
      c.height = this.naturalHeight;
      ctx.drawImage(this, 0, 0);
      c.toBlob(
        blob => {
          // here the image is a blob
          resolve(blob);
        },
        "image/png",
        0.75
      );
    };
  });
}

async function copyImage(imageURL) {
  const blob = await imageToBlob(imageURL);
  const item = new ClipboardItem({ "image/png": blob });
  navigator.clipboard.write([item]);
}

rm.copyUrl = function (id) {
  const input = document.createElement("input"); // Create a new <input> element
  input.id = "copyVal"; // Set the id of the new element to "copyVal"
  document.body.appendChild(input); // Append the new element to the end of the <body> element
  
  const text = id;
  input.value = text;
  input.select();
  input.setSelectionRange(0, input.value.length);
  document.execCommand("copy");
  
  input.remove(); // Remove the <input> element from the DOM
};

function stopMaskScroll() {
  if (document.getElementById("rightmenu-mask")) {
    let xscroll = document.getElementById("rightmenu-mask");
    xscroll.addEventListener(
      "mousewheel",
      function (e) {
        //阻止浏览器默认方法
        rm.hideRightMenu();
        // e.preventDefault();
      },
      { passive: true }
    );
  }
  if (document.getElementById("rightMenu")) {
    let xscroll = document.getElementById("rightMenu");
    xscroll.addEventListener(
      "mousewheel",
      function (e) {
        //阻止浏览器默认方法
        rm.hideRightMenu();
        // e.preventDefault();
      },
      { passive: true }
    );
  }
}

rm.rightmenuCopyText = function (txt) {
  if (navigator.clipboard) {
    navigator.clipboard.writeText(txt);
  }
  rm.hideRightMenu();
};

rm.copyPageUrl = function (url) {
  if (!url) {
    url = window.location.href;
  }
  rm.copyUrl(url);
  anzhiyu.snackbarShow("复制链接地址成功", false, 2000);
  rm.hideRightMenu();
};

rm.sharePage = function () {
  var content = window.location.href;
  rm.copyUrl(url);
  anzhiyu.snackbarShow("复制链接地址成功", false, 2000);
  rm.hideRightMenu();
};

// 复制当前选中文本
var selectTextNow = "";
document.onmouseup = document.ondblclick = selceText;

function selceText() {
  var txt;
  if (document.selection) {
    txt = document.selection.createRange().text;
  } else {
    txt = window.getSelection().toString();
  }
  selectTextNow = txt !== "" ? txt : "";
}

// 读取剪切板
rm.readClipboard = function () {
  if (navigator.clipboard) {
    navigator.clipboard.readText().then(clipText => rm.insertAtCaret(globalEvent.target, clipText));
  }
};

// 粘贴文本到焦点
rm.insertAtCaret = function (elemt, value) {
  const startPos = elemt.selectionStart,
    endPos = elemt.selectionEnd;
  if (document.selection) {
    elemt.focus();
    var sel = document.selection.createRange();
    sel.text = value;
    elemt.focus();
  } else {
    if (startPos || startPos == "0") {
      var scrollTop = elemt.scrollTop;
      elemt.value = elemt.value.substring(0, startPos) + value + elemt.value.substring(endPos, elemt.value.length);
      elemt.focus();
      elemt.selectionStart = startPos + value.length;
      elemt.selectionEnd = startPos + value.length;
      elemt.scrollTop = scrollTop;
    } else {
      elemt.value += value;
      elemt.focus();
    }
  }
};

//粘贴文本
rm.pasteText = function () {
  const result = rm.readClipboard() || "";
  rm.hideRightMenu();
};

//引用到评论
rm.rightMenuCommentText = function (txt) {
  rm.hideRightMenu();
  const postCommentDom = document.getElementById("post-comment");
  var domTop = postCommentDom.offsetTop;
  window.scrollTo(0, domTop - 80);
  if (txt == "undefined" || txt == "null") txt = "好棒！";
  function setText() {
    setTimeout(() => {
      var input = document.getElementsByClassName("el-textarea__inner")[0];
      if (!input) setText();
      let evt = document.createEvent("HTMLEvents");
      evt.initEvent("input", true, true);
      let inputValue = replaceAll(txt, "\n", "\n> ");
      input.value = "> " + inputValue + "\n\n";
      input.dispatchEvent(evt);
      input.focus();
      input.setSelectionRange(-1, -1);
      if (document.getElementById("comment-tips")) {
        document.getElementById("comment-tips").classList.add("show");
      }
    }, 100);
  }
  setText();
};

//替换所有内容
function replaceAll(string, search, replace) {
  return string.split(search).join(replace);
}

// 百度搜索
rm.searchBaidu = function () {
  anzhiyu.snackbarShow("即将跳转到百度搜索", false, 2000);
  setTimeout(function () {
    window.open("https://www.baidu.com/s?wd=" + selectTextNow);
  }, "2000");
  rm.hideRightMenu();
};

//分享链接
rm.copyLink = function () {
  rm.rightmenuCopyText(domhref);
  anzhiyu.snackbarShow("已复制链接地址");
};

function addRightMenuClickEvent() {
  // 添加点击事件
  document.getElementById("menu-backward").addEventListener("click", function () {
  window.history.back();
    rm.hideRightMenu();
  });

  document.getElementById("menu-forward").addEventListener("click", function () {
    window.history.forward();
    rm.hideRightMenu();
  });

  document.getElementById("menu-refresh").addEventListener("click", function () {
    window.location.reload();
  });

  document.getElementById("menu-top").addEventListener("click", function () {
    anzhiyu.scrollToDest(0, 500);
    rm.hideRightMenu();
  });

  const menuLinks = document.querySelectorAll(".menu-link");
  menuLinks.forEach(function (link) {
    link.addEventListener("click", rm.hideRightMenu);
  });

  document.getElementById("menu-darkmode").addEventListener("click", anzhiyu.switchDarkMode);

  document.getElementById("menu-home") && document.getElementById("menu-home").addEventListener("click", function () {
    window.location.href = window.location.origin;
  });

  document.getElementById("menu-randomPost").addEventListener("click", function () {
    toRandomPost();
  });

  document.getElementById("menu-commentBarrage").addEventListener("click", anzhiyu.switchCommentBarrage);

  document.getElementById("rightmenu-mask").addEventListener("click", rm.hideRightMenu);

  document.getElementById("rightmenu-mask").addEventListener("contextmenu", function (event) {
    rm.hideRightMenu();
    event.preventDefault(); // Prevent the default context menu from appearing
  });

  document.getElementById("menu-copy").addEventListener("click", rm.copyPageUrl);

  document.getElementById("menu-pastetext").addEventListener("click", rm.pasteText);

  document.getElementById("menu-copytext").addEventListener("click", function () {
    rm.rightmenuCopyText(selectTextNow);
    anzhiyu.snackbarShow("复制成功，复制和转载请标注本文地址");
  });

  document.getElementById("menu-commenttext").addEventListener("click", function () {
    rm.rightMenuCommentText(selectTextNow);
  });

  document.getElementById("menu-newwindow").addEventListener("click", function () {
    window.open(domhref, "_blank");
    rm.hideRightMenu();
  });

  document.getElementById("menu-copylink").addEventListener("click", rm.copyLink);

  document.getElementById("menu-downloadimg").addEventListener("click", function () {
    anzhiyu.downloadImage(domImgSrc, "anzhiyu");
  });

  document.getElementById("menu-newwindowimg").addEventListener("click", function () {
    window.open(domImgSrc, "_blank");
    rm.hideRightMenu();
  });

  document.getElementById("menu-copyimg").addEventListener("click", function () {
    rm.writeClipImg(domImgSrc);
  });

  document.getElementById("menu-searchBaidu").addEventListener("click", rm.searchBaidu);

  //音乐
  document.getElementById("menu-music-toggle").addEventListener("click", anzhiyu.musicToggle);

  document.getElementById("menu-music-back").addEventListener("click", anzhiyu.musicSkipBack);

  document.getElementById("menu-music-forward").addEventListener("click", anzhiyu.musicSkipForward);

  document.getElementById("menu-music-copyMusicName").addEventListener("click", function () {
    rm.rightmenuCopyText(anzhiyu.musicGetName());
    anzhiyu.snackbarShow("复制歌曲名称成功", false, 3000);
  });

}

addRightMenuClickEvent();</script><script data-pjax>var themeColorMeta = document.querySelector('meta[name="theme-color"]');
var pageHeaderEl = document.getElementById("page-header");
var navMusicEl = document.getElementById("nav-music");
var consoleEl = document.getElementById("console");
// 已随机的歌曲
var selectRandomSong = [];
// 音乐默认声音大小
var musicVolume = 0.8;
// 是否切换了周杰伦音乐列表
var changeMusicListFlag = false;
// 当前默认播放列表
var defaultPlayMusicList = [];

document.getElementById("page-name").innerText = document.title.split(" | Rshimmer")[0];
anzhiyu.initIndexEssay();
anzhiyu.changeTimeInEssay();
anzhiyu.removeBodyPaceClass();
anzhiyu.qrcodeCreate();
anzhiyu.changeTimeInAlbumDetail();
anzhiyu.reflashEssayWaterFall();
anzhiyu.sayhi();
anzhiyu.stopImgRightDrag();
anzhiyu.addNavBackgroundInit();
anzhiyu.setValueToBodyType();
anzhiyu.catalogActive();
anzhiyu.tagsPageActive();
anzhiyu.categoriesBarActive();
anzhiyu.topCategoriesBarScroll();
anzhiyu.switchRightClickMenuHotReview();
anzhiyu.getCustomPlayList();
anzhiyu.addEventListenerConsoleMusicList(false);
setTimeout(() => {if (typeof addFriendLinksInFooter === "function") {addFriendLinksInFooter();}}, 200)</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><script data-pjax>var parent,child;document.getElementById("recent-posts")&&"/"===location.pathname&&(parent=document.getElementById("recent-posts"),child='<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://Rshimmering.github.io/categories/Excel/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📚 Excel (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://Rshimmering.github.io/categories/hexo/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📚 hexo (6)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://Rshimmering.github.io/categories/数据分析、数据挖掘项目/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📚 数据分析、数据挖掘项目 (4)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://Rshimmering.github.io/categories/《统计学-第7版》思考题/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📚 《统计学_第7版》思考题 (14)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><a class="magnet_link_more"  href="https://Rshimmering.github.io/categories" style="flex:1;text-align: center;margin-bottom: 10px;">查看更多...</a></div></div>',console.log("已挂载magnet"),parent.insertAdjacentHTML("afterbegin",child))</script><style>#catalog_magnet{flex-wrap:wrap;display:flex;width:100%;justify-content:space-between;padding:10px 10px 0 10px;align-content:flex-start}.magnet_item{flex-basis:calc(50% - 5px);background:#1f4e79;margin-bottom:10px;border-radius:8px;transition:all .2s ease-in-out}.magnet_item:hover{background:#1f4e79}.magnet_link_more{color:#555}.magnet_link{color:#fff}.magnet_link:hover{color:#d2b4de}@media screen and (max-width:600px){.magnet_item{flex-basis:100%}}.magnet_link_context{display:flex;padding:10px;font-size:16px;transition:all .2s ease-in-out}.magnet_link_context:hover{padding:10px 20px}</style><style></style></body></html>